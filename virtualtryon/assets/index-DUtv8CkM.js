import{r as tt,g as Ut,a as ar}from"./vendor-DDxydHEc.js";import{P as lr,S as cr}from"./mediapipe-iWp-KiSB.js";import{_ as Bt,a as ur,b as lt}from"./transformers-Bfy1C51G.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Me={exports:{}},ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ct;function dr(){if(ct)return ie;ct=1;var n=tt(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var d,f={},g=null,h=null;c!==void 0&&(g=""+c),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(h=l.ref);for(d in l)r.call(l,d)&&!i.hasOwnProperty(d)&&(f[d]=l[d]);if(a&&a.defaultProps)for(d in l=a.defaultProps,l)f[d]===void 0&&(f[d]=l[d]);return{$$typeof:e,type:a,key:g,ref:h,props:f,_owner:s.current}}return ie.Fragment=t,ie.jsx=o,ie.jsxs=o,ie}var ut;function fr(){return ut||(ut=1,Me.exports=dr()),Me.exports}var u=fr(),x=tt();const fe=Ut(x);var Ce={},dt;function gr(){if(dt)return Ce;dt=1;var n=ar();return Ce.createRoot=n.createRoot,Ce.hydrateRoot=n.hydrateRoot,Ce}var hr=gr();const pr=Ut(hr),S=n=>typeof n=="string",oe=()=>{let n,e;const t=new Promise((r,s)=>{n=r,e=s});return t.resolve=n,t.reject=e,t},ft=n=>n==null?"":""+n,mr=(n,e,t)=>{n.forEach(r=>{e[r]&&(t[r]=e[r])})},xr=/###/g,gt=n=>n&&n.indexOf("###")>-1?n.replace(xr,"."):n,ht=n=>!n||S(n),ge=(n,e,t)=>{const r=S(e)?e.split("."):e;let s=0;for(;s<r.length-1;){if(ht(n))return{};const i=gt(r[s]);!n[i]&&t&&(n[i]=new t),Object.prototype.hasOwnProperty.call(n,i)?n=n[i]:n={},++s}return ht(n)?{}:{obj:n,k:gt(r[s])}},pt=(n,e,t)=>{const{obj:r,k:s}=ge(n,e,Object);if(r!==void 0||e.length===1){r[s]=t;return}let i=e[e.length-1],o=e.slice(0,e.length-1),a=ge(n,o,Object);for(;a.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),a=ge(n,o,Object),a?.obj&&typeof a.obj[`${a.k}.${i}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${i}`]=t},yr=(n,e,t,r)=>{const{obj:s,k:i}=ge(n,e,Object);s[i]=s[i]||[],s[i].push(t)},Ee=(n,e)=>{const{obj:t,k:r}=ge(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r]},br=(n,e,t)=>{const r=Ee(n,t);return r!==void 0?r:Ee(e,t)},Ht=(n,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in n?S(n[r])||n[r]instanceof String||S(e[r])||e[r]instanceof String?t&&(n[r]=e[r]):Ht(n[r],e[r],t):n[r]=e[r]);return n},re=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var vr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const wr=n=>S(n)?n.replace(/[&<>"'\/]/g,e=>vr[e]):n;class Sr{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const Cr=[" ",",","?","!",";"],Nr=new Sr(20),Rr=(n,e,t)=>{e=e||"",t=t||"";const r=Cr.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(r.length===0)return!0;const s=Nr.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(n);if(!i){const o=n.indexOf(t);o>0&&!s.test(n.substring(0,o))&&(i=!0)}return i},He=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const r=e.split(t);let s=n;for(let i=0;i<r.length;){if(!s||typeof s!="object")return;let o,a="";for(let l=i;l<r.length;++l)if(l!==i&&(a+=t),a+=r[l],o=s[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;i+=l-i+1;break}s=o}return s},pe=n=>n?.replace("_","-"),Er={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){console?.[n]?.apply?.(console,e)}};class Pe{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||Er,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,s){return s&&!this.debug?null:(S(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Pe(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Pe(this.logger,e)}}var X=new Pe;class Oe{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(t)||0;this.observers[r].set(t,s+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s.apply(s,[e,...t])})}}class mt extends Oe{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r,s={}){const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],r&&(Array.isArray(r)?a.push(...r):S(r)&&i?a.push(...r.split(i)):a.push(r)));const l=Ee(this.data,a);return!l&&!t&&!r&&e.indexOf(".")>-1&&(e=a[0],t=a[1],r=a.slice(2).join(".")),l||!o||!S(r)?l:He(this.data?.[e]?.[t],r,i)}addResource(e,t,r,s,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let a=[e,t];r&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(a=e.split("."),s=t,t=a[1]),this.addNamespaces(t),pt(this.data,a,s),i.silent||this.emit("added",e,t,r,s)}addResources(e,t,r,s={silent:!1}){for(const i in r)(S(r[i])||Array.isArray(r[i]))&&this.addResource(e,t,i,r[i],{silent:!0});s.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,s,i,o={silent:!1,skipCopy:!1}){let a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),s=r,r=t,t=a[1]),this.addNamespaces(t);let l=Ee(this.data,a)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?Ht(l,r,i):l={...l,...r},pt(this.data,a,l),o.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(s=>t[s]&&Object.keys(t[s]).length>0)}toJSON(){return this.data}}var Gt={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,r,s){return n.forEach(i=>{e=this.processors[i]?.process(e,t,r,s)??e}),e}};const Vt=Symbol("i18next/PATH_KEY");function Pr(){const n=[],e=Object.create(null);let t;return e.get=(r,s)=>(t?.revoke?.(),s===Vt?n:(n.push(s),t=Proxy.revocable(r,e),t.proxy)),Proxy.revocable(Object.create(null),e).proxy}function Ge(n,e){const{[Vt]:t}=n(Pr());return t.join(e?.keySeparator??".")}const xt={},Ae=n=>!S(n)&&typeof n!="boolean"&&typeof n!="number";class Le extends Oe{constructor(e,t={}){super(),mr(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=X.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const r={...t};if(e==null)return!1;const s=this.resolve(e,r);if(s?.res===void 0)return!1;const i=Ae(s.res);return!(r.returnObjects===!1&&i)}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let i=t.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Rr(e,r,s);if(o&&!a){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:S(i)?[i]:i};const c=e.split(r);(r!==s||r===s&&this.options.ns.indexOf(c[0])>-1)&&(i=c.shift()),e=c.join(s)}return{key:e,namespaces:S(i)?[i]:i}}translate(e,t,r){let s=typeof t=="object"?{...t}:t;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=Ge(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const i=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:a,namespaces:l}=this.extractFromKey(e[e.length-1],s),c=l[l.length-1];let d=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const f=s.lng||this.language,g=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(f?.toLowerCase()==="cimode")return g?i?{res:`${c}${d}${a}`,usedKey:a,exactUsedKey:a,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:`${c}${d}${a}`:i?{res:a,usedKey:a,exactUsedKey:a,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:a;const h=this.resolve(e,s);let p=h?.res;const m=h?.usedKey||a,y=h?.exactUsedKey||a,w=["[object Number]","[object Function]","[object RegExp]"],C=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,F=!this.i18nFormat||this.i18nFormat.handleAsObject,_=s.count!==void 0&&!S(s.count),b=Le.hasDefaultValue(s),O=_?this.pluralResolver.getSuffix(f,s.count,s):"",R=s.ordinal&&_?this.pluralResolver.getSuffix(f,s.count,{ordinal:!1}):"",E=_&&!s.ordinal&&s.count===0,N=E&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${O}`]||s[`defaultValue${R}`]||s.defaultValue;let P=p;F&&!p&&b&&(P=N);const L=Ae(P),V=Object.prototype.toString.apply(P);if(F&&P&&L&&w.indexOf(V)<0&&!(S(C)&&Array.isArray(P))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const v=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,P,{...s,ns:l}):`key '${a} (${this.language})' returned an object instead of string.`;return i?(h.res=v,h.usedParams=this.getUsedParamsDetails(s),h):v}if(o){const v=Array.isArray(P),k=v?[]:{},T=v?y:m;for(const D in P)if(Object.prototype.hasOwnProperty.call(P,D)){const I=`${T}${o}${D}`;b&&!p?k[D]=this.translate(I,{...s,defaultValue:Ae(N)?N[D]:void 0,joinArrays:!1,ns:l}):k[D]=this.translate(I,{...s,joinArrays:!1,ns:l}),k[D]===I&&(k[D]=P[D])}p=k}}else if(F&&S(C)&&Array.isArray(p))p=p.join(C),p&&(p=this.extendTranslation(p,e,s,r));else{let v=!1,k=!1;!this.isValidLookup(p)&&b&&(v=!0,p=N),this.isValidLookup(p)||(k=!0,p=a);const D=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&k?void 0:p,I=b&&N!==p&&this.options.updateMissing;if(k||v||I){if(this.logger.log(I?"updateKey":"missingKey",f,c,a,I?N:p),o){const $=this.resolve(a,{...s,keySeparator:!1});$&&$.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let M=[];const A=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&A&&A[0])for(let $=0;$<A.length;$++)M.push(A[$]);else this.options.saveMissingTo==="all"?M=this.languageUtils.toResolveHierarchy(s.lng||this.language):M.push(s.lng||this.language);const z=($,B,q)=>{const we=b&&q!==p?q:D;this.options.missingKeyHandler?this.options.missingKeyHandler($,c,B,we,I,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing($,c,B,we,I,s),this.emit("missingKey",$,c,B,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?M.forEach($=>{const B=this.pluralResolver.getSuffixes($,s);E&&s[`defaultValue${this.options.pluralSeparator}zero`]&&B.indexOf(`${this.options.pluralSeparator}zero`)<0&&B.push(`${this.options.pluralSeparator}zero`),B.forEach(q=>{z([$],a+q,s[`defaultValue${q}`]||N)})}):z(M,a,N))}p=this.extendTranslation(p,e,s,h,r),k&&p===a&&this.options.appendNamespaceToMissingKey&&(p=`${c}${d}${a}`),(k||v)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${d}${a}`:a,v?p:void 0,s))}return i?(h.res=p,h.usedParams=this.getUsedParamsDetails(s),h):p}extendTranslation(e,t,r,s,i){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const l=S(e)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(l){const f=e.match(this.interpolator.nestingRegexp);c=f&&f.length}let d=r.replace&&!S(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,r.lng||this.language||s.usedLng,r),l){const f=e.match(this.interpolator.nestingRegexp),g=f&&f.length;c<g&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...f)=>i?.[0]===f[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${t[0]}`),null):this.translate(...f,t),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,a=S(o)?[o]:o;return e!=null&&a?.length&&r.applyPostProcessor!==!1&&(e=Gt.handle(a,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,t={}){let r,s,i,o,a;return S(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const c=this.extractFromKey(l,t),d=c.key;s=d;let f=c.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const g=t.count!==void 0&&!S(t.count),h=g&&!t.ordinal&&t.count===0,p=t.context!==void 0&&(S(t.context)||typeof t.context=="number")&&t.context!=="",m=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);f.forEach(y=>{this.isValidLookup(r)||(a=y,!xt[`${m[0]}-${y}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(a)&&(xt[`${m[0]}-${y}`]=!0,this.logger.warn(`key "${s}" for languages "${m.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(w=>{if(this.isValidLookup(r))return;o=w;const C=[d];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(C,d,w,y,t);else{let _;g&&(_=this.pluralResolver.getSuffix(w,t.count,t));const b=`${this.options.pluralSeparator}zero`,O=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(g&&(t.ordinal&&_.indexOf(O)===0&&C.push(d+_.replace(O,this.options.pluralSeparator)),C.push(d+_),h&&C.push(d+b)),p){const R=`${d}${this.options.contextSeparator||"_"}${t.context}`;C.push(R),g&&(t.ordinal&&_.indexOf(O)===0&&C.push(R+_.replace(O,this.options.pluralSeparator)),C.push(R+_),h&&C.push(R+b))}}let F;for(;F=C.pop();)this.isValidLookup(r)||(i=F,r=this.getResource(w,y,F,t))}))})}),{res:r,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,r,s):this.resourceStore.getResource(e,t,r,s)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!S(e.replace);let s=r?e.replace:e;if(r&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const i of t)delete s[i]}return s}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}class yt{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=X.create("languageUtils")}getScriptPartFromCode(e){if(e=pe(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=pe(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(S(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(t=s)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const s=this.getScriptPartFromCode(r);if(this.isSupportedCode(s))return t=s;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),S(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return S(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):S(e)&&i(this.formatLanguageCode(e)),r.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}const bt={zero:0,one:1,two:2,few:3,many:4,other:5},vt={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Lr{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=X.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const r=pe(e==="dev"?"en":e),s=t.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),vt;if(!e.match(/-|_/))return vt;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,t)}return this.pluralRulesCache[i]=o,o}needsPlural(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,r={}){return this.getSuffixes(e,r).map(s=>`${t}${s}`)}getSuffixes(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort((s,i)=>bt[s]-bt[i]).map(s=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,t,r={}){const s=this.getRule(e,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const wt=(n,e,t,r=".",s=!0)=>{let i=br(n,e,t);return!i&&s&&S(t)&&(i=He(n,t,r),i===void 0&&(i=He(e,t,r))),i},De=n=>n.replace(/\$/g,"$$$$");class kr{constructor(e={}){this.logger=X.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(t=>t),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:a,suffixEscaped:l,formatSeparator:c,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:g,nestingPrefixEscaped:h,nestingSuffix:p,nestingSuffixEscaped:m,nestingOptionsSeparator:y,maxReplaces:w,alwaysFormat:C}=e.interpolation;this.escape=t!==void 0?t:wr,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?re(i):o||"{{",this.suffix=a?re(a):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=g?re(g):h||re("$t("),this.nestingSuffix=p?re(p):m||re(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=w||1e3,this.alwaysFormat=C!==void 0?C:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>t?.source===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,r,s){let i,o,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=h=>{if(h.indexOf(this.formatSeparator)<0){const w=wt(t,l,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(w,void 0,r,{...s,...t,interpolationkey:h}):w}const p=h.split(this.formatSeparator),m=p.shift().trim(),y=p.join(this.formatSeparator).trim();return this.format(wt(t,l,m,this.options.keySeparator,this.options.ignoreJSONStructure),y,r,{...s,...t,interpolationkey:m})};this.resetRegExp();const d=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,f=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>De(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?De(this.escape(h)):De(h)}].forEach(h=>{for(a=0;i=h.regex.exec(e);){const p=i[1].trim();if(o=c(p),o===void 0)if(typeof d=="function"){const y=d(e,i,s);o=S(y)?y:""}else if(s&&Object.prototype.hasOwnProperty.call(s,p))o="";else if(f){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${p} for interpolating ${e}`),o="";else!S(o)&&!this.useRawValueToEscape&&(o=ft(o));const m=h.safeValue(o);if(e=e.replace(i[0],m),f?(h.regex.lastIndex+=o.length,h.regex.lastIndex-=i[0].length):h.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,t,r={}){let s,i,o;const a=(l,c)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let g=`{${f[1]}`;l=f[0],g=this.interpolate(g,o);const h=g.match(/'/g),p=g.match(/"/g);((h?.length??0)%2===0&&!p||p.length%2!==0)&&(g=g.replace(/'/g,'"'));try{o=JSON.parse(g),c&&(o={...c,...o})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,m),`${l}${d}${g}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;s=this.nestingRegexp.exec(e);){let l=[];o={...r},o=o.replace&&!S(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const c=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(c!==-1&&(l=s[1].slice(c).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),s[1]=s[1].slice(0,c)),i=t(a.call(this,s[1].trim(),o),o),i&&s[0]===e&&!S(i))return i;S(i)||(i=ft(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),l.length&&(i=l.reduce((d,f)=>this.format(d,f,r.lng,{...r,interpolationkey:s[1].trim()}),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}const jr=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const r=n.split("(");e=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);e==="currency"&&s.indexOf(":")<0?t.currency||(t.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?t.range||(t.range=s.trim()):s.split(";").forEach(o=>{if(o){const[a,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),d=a.trim();t[d]||(t[d]=c),c==="false"&&(t[d]=!1),c==="true"&&(t[d]=!0),isNaN(c)||(t[d]=parseInt(c,10))}})}return{formatName:e,formatOptions:t}},St=n=>{const e={};return(t,r,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=r+JSON.stringify(i);let a=e[o];return a||(a=n(pe(r),s),e[o]=a),a(t)}},_r=n=>(e,t,r)=>n(pe(t),r)(e);class Or{constructor(e={}){this.logger=X.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const r=t.cacheInBuiltFormats?St:_r;this.formats={number:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i});return a=>o.format(a)}),currency:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i,style:"currency"});return a=>o.format(a)}),datetime:r((s,i)=>{const o=new Intl.DateTimeFormat(s,{...i});return a=>o.format(a)}),relativetime:r((s,i)=>{const o=new Intl.RelativeTimeFormat(s,{...i});return a=>o.format(a,i.range||"day")}),list:r((s,i)=>{const o=new Intl.ListFormat(s,{...i});return a=>o.format(a)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=St(t)}format(e,t,r,s={}){const i=t.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(a=>a.indexOf(")")>-1)){const a=i.findIndex(l=>l.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,a)].join(this.formatSeparator)}return i.reduce((a,l)=>{const{formatName:c,formatOptions:d}=jr(l);if(this.formats[c]){let f=a;try{const g=s?.formatParams?.[s.interpolationkey]||{},h=g.locale||g.lng||s.locale||s.lng||r;f=this.formats[c](a,h,{...d,...s,...g})}catch(g){this.logger.warn(g)}return f}else this.logger.warn(`there was no format function for ${c}`);return a},e)}}const Tr=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class Fr extends Oe{constructor(e,t,r,s={}){super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=X.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,s.backend,s)}queueLoad(e,t,r,s){const i={},o={},a={},l={};return e.forEach(c=>{let d=!0;t.forEach(f=>{const g=`${c}|${f}`;!r.reload&&this.store.hasResourceBundle(c,f)?this.state[g]=2:this.state[g]<0||(this.state[g]===1?o[g]===void 0&&(o[g]=!0):(this.state[g]=1,d=!1,o[g]===void 0&&(o[g]=!0),i[g]===void 0&&(i[g]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(a[c]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,t,r){const s=e.split("|"),i=s[0],o=s[1];t&&this.emit("failedLoading",i,o,t),!t&&r&&this.store.addResourceBundle(i,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const a={};this.queue.forEach(l=>{yr(l.loaded,[i],o),Tr(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{a[c]||(a[c]={});const d=l.loaded[c];d.length&&d.forEach(f=>{a[c][f]===void 0&&(a[c][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(e,t,r,s=0,i=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:s,wait:i,callback:o});return}this.readingCalls++;const a=(c,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(c&&d&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,s+1,i*2,o)},i);return}o(c,d)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const c=l(e,t);c&&typeof c.then=="function"?c.then(d=>a(null,d)).catch(a):a(null,c)}catch(c){a(c)}return}return l(e,t,a)}prepareLoading(e,t,r={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();S(e)&&(e=this.languageUtils.toResolveHierarchy(e)),S(t)&&(t=[t]);const i=this.queueLoad(e,t,r,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e,t=""){const r=e.split("|"),s=r[0],i=r[1];this.read(s,i,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${t}loading namespace ${i} for language ${s} failed`,o),!o&&a&&this.logger.log(`${t}loaded namespace ${i} for language ${s}`,a),this.loaded(e,o,a)})}saveMissing(e,t,r,s,i,o={},a=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const l={...o,isUpdate:i},c=this.backend.create.bind(this.backend);if(c.length<6)try{let d;c.length===5?d=c(e,t,r,s,l):d=c(e,t,r,s),d&&typeof d.then=="function"?d.then(f=>a(null,f)).catch(a):a(null,d)}catch(d){a(d)}else c(e,t,r,s,a,l)}!e||!e[0]||this.store.addResource(e[0],t,r,s)}}}const Ct=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),S(n[1])&&(e.defaultValue=n[1]),S(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),Nt=n=>(S(n.ns)&&(n.ns=[n.ns]),S(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),S(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs?.indexOf?.("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n),Ne=()=>{},Ir=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class he extends Oe{constructor(e={},t){if(super(),this.options=Nt(e),this.services={},this.logger=X,this.modules={external:[]},Ir(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(S(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=Ct();this.options={...r,...this.options,...Nt(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const s=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?X.init(s(this.modules.logger),this.options):X.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=Or;const d=new yt(this.options);this.store=new mt(this.options.resources,this.options);const f=this.services;f.logger=X,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new Lr(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(f.formatter=s(c),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new kr(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Fr(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(h,...p)=>{this.emit(h,...p)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Le(this.services,this.options),this.translator.on("*",(h,...p)=>{this.emit(h,...p)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Ne),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...d)=>this.store[c](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...d)=>(this.store[c](...d),this)});const a=oe(),l=()=>{const c=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(f),t(d,f)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),a}loadResources(e,t=Ne){let r=t;const s=S(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],o=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(c=>{c!=="cimode"&&i.indexOf(c)<0&&i.push(c)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>o(l)),this.options.preload?.forEach?.(a=>o(a)),this.services.backendConnector.load(i,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(a)})}else r(null)}reloadResources(e,t,r){const s=oe();return typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=Ne),this.services.backendConnector.reload(e,t,i=>{s.resolve(),r(i)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Gt.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const r=oe();this.emit("languageChanging",e);const s=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},i=(a,l)=>{l?this.isLanguageChangingTo===e&&(s(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,r.resolve((...c)=>this.t(...c)),t&&t(a,(...c)=>this.t(...c))},o=a=>{!e&&!a&&this.services.languageDetector&&(a=[]);const l=S(a)?a:a&&a[0],c=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(S(a)?[a]:a);c&&(this.language||s(c),this.translator.language||this.translator.changeLanguage(c),this.services.languageDetector?.cacheUserLanguage?.(c)),this.loadResources(c,d=>{i(d,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,t,r){const s=(i,o,...a)=>{let l;typeof o!="object"?l=this.options.overloadTranslationOptionHandler([i,o].concat(a)):l={...o},l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||s.keyPrefix);const c=this.options.keySeparator||".";let d;return l.keyPrefix&&Array.isArray(i)?d=i.map(f=>(typeof f=="function"&&(f=Ge(f,{...this.options,...o})),`${l.keyPrefix}${c}${f}`)):(typeof i=="function"&&(i=Ge(i,{...this.options,...o})),d=l.keyPrefix?`${l.keyPrefix}${c}${i}`:i),this.t(d,l)};return S(e)?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=r,s}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(a,l)=>{const c=this.services.backendConnector.state[`${a}|${l}`];return c===-1||c===0||c===2};if(t.precheck){const a=t.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!s||o(i,e)))}loadNamespaces(e,t){const r=oe();return this.options.ns?(S(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),t&&t(s)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=oe();S(e)&&(e=[e]);const s=this.options.preload||[],i=e.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{r.resolve(),t&&t(o)}),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const s=new Intl.Locale(e);if(s&&s.getTextInfo){const i=s.getTextInfo();if(i&&i.direction)return i.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new yt(Ct());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){const r=new he(e,t);return r.createInstance=he.createInstance,r}cloneInstance(e={},t=Ne){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},i=new he(s);if((e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(a=>{i[a]=this[a]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const a=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},l[c]=Object.keys(l[c]).reduce((d,f)=>(d[f]={...l[c][f]},d),l[c]),l),{});i.store=new mt(a,s),i.services.resourceStore=i.store}return i.translator=new Le(i.services,s),i.translator.on("*",(a,...l)=>{i.emit(a,...l)}),i.init(s,t),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const U=he.createInstance();U.createInstance;U.dir;U.init;U.loadResources;U.reloadResources;U.use;U.changeLanguage;U.getFixedT;U.t;U.exists;U.setDefaultNamespace;U.hasLoadedNamespace;U.loadNamespaces;U.loadLanguages;const Mr=(n,e,t,r)=>{const s=[t,{code:e,...r||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);J(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...s):console?.warn&&console.warn(...s)},Rt={},Wt=(n,e,t,r)=>{J(t)&&Rt[t]||(J(t)&&(Rt[t]=new Date),Mr(n,e,t,r))},Kt=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},Ve=(n,e,t)=>{n.loadNamespaces(e,Kt(n,t))},Et=(n,e,t,r)=>{if(J(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return Ve(n,t,r);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,Kt(n,r))},Ar=(n,e,t={})=>!e.languages||!e.languages.length?(Wt(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,s)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,n))return!1}}),J=n=>typeof n=="string",Dr=n=>typeof n=="object"&&n!==null,$r=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,zr={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},Ur=n=>zr[n],Br=n=>n.replace($r,Ur);let We={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Br};const Hr=(n={})=>{We={...We,...n}},Gr=()=>We;let qt;const Vr=n=>{qt=n},Wr=()=>qt,Kr={type:"3rdParty",init(n){Hr(n.options.react),Vr(n)}},qr=x.createContext();class Xr{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var $e={exports:{}},ze={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pt;function Yr(){if(Pt)return ze;Pt=1;var n=tt();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,o=n.useDebugValue;function a(f,g){var h=g(),p=r({inst:{value:h,getSnapshot:g}}),m=p[0].inst,y=p[1];return i(function(){m.value=h,m.getSnapshot=g,l(m)&&y({inst:m})},[f,h,g]),s(function(){return l(m)&&y({inst:m}),f(function(){l(m)&&y({inst:m})})},[f]),o(h),h}function l(f){var g=f.getSnapshot;f=f.value;try{var h=g();return!t(f,h)}catch{return!0}}function c(f,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return ze.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,ze}var Lt;function Jr(){return Lt||(Lt=1,$e.exports=Yr()),$e.exports}var Zr=Jr();const Qr=(n,e)=>J(e)?e:Dr(e)&&J(e.defaultValue)?e.defaultValue:Array.isArray(n)?n[n.length-1]:n,en={t:Qr,ready:!1},tn=()=>()=>{},be=(n,e={})=>{const{i18n:t}=e,{i18n:r,defaultNS:s}=x.useContext(qr)||{},i=t||r||Wr();i&&!i.reportNamespaces&&(i.reportNamespaces=new Xr),i||Wt(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=x.useMemo(()=>({...Gr(),...i?.options?.react,...e}),[i,e]),{useSuspense:a,keyPrefix:l}=o,c=x.useMemo(()=>{const R=s||i?.options?.defaultNS;return J(R)?[R]:R||["translation"]},[n,s,i]);i?.reportNamespaces?.addUsedNamespaces?.(c);const d=x.useRef(0),f=x.useCallback(R=>{if(!i)return tn;const{bindI18n:E,bindI18nStore:N}=o,P=()=>{d.current+=1,R()};return E&&i.on(E,P),N&&i.store.on(N,P),()=>{E&&E.split(" ").forEach(L=>i.off(L,P)),N&&N.split(" ").forEach(L=>i.store.off(L,P))}},[i,o]),g=x.useRef(),h=x.useCallback(()=>{if(!i)return en;const R=!!(i.isInitialized||i.initializedStoreOnce)&&c.every(v=>Ar(v,i,o)),E=e.lng||i.language,N=d.current,P=g.current;if(P&&P.ready===R&&P.lng===E&&P.keyPrefix===l&&P.revision===N)return P;const V={t:i.getFixedT(E,o.nsMode==="fallback"?c:c[0],l),ready:R,lng:E,keyPrefix:l,revision:N};return g.current=V,V},[i,c,l,o,e.lng]),[p,m]=x.useState(0),{t:y,ready:w}=Zr.useSyncExternalStore(f,h,h);x.useEffect(()=>{if(i&&!w&&!a){const R=()=>m(E=>E+1);e.lng?Et(i,e.lng,c,R):Ve(i,c,R)}},[i,e.lng,c,w,a,p]);const C=i||{},F=x.useRef(null),_=x.useRef(),b=R=>{const E=Object.getOwnPropertyDescriptors(R);E.__original&&delete E.__original;const N=Object.create(Object.getPrototypeOf(R),E);if(!Object.prototype.hasOwnProperty.call(N,"__original"))try{Object.defineProperty(N,"__original",{value:R,writable:!1,enumerable:!1,configurable:!1})}catch{}return N},O=x.useMemo(()=>{const R=C,E=R?.language;let N=R;R&&(F.current&&F.current.__original===R?_.current!==E?(N=b(R),F.current=N,_.current=E):N=F.current:(N=b(R),F.current=N,_.current=E));const P=[y,N,w];return P.t=y,P.i18n=N,P.ready=w,P},[y,C,w,C.resolvedLanguage,C.language,C.languages]);if(i&&a&&!w)throw new Promise(R=>{const E=()=>R();e.lng?Et(i,e.lng,c,E):Ve(i,c,E)});return O};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xt=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=x.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>x.createElement("svg",{ref:l,...nn,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:Xt("lucide",s),...a},[...o.map(([c,d])=>x.createElement(c,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=(n,e)=>{const t=x.forwardRef(({className:r,...s},i)=>x.createElement(sn,{ref:i,iconNode:e,className:Xt(`lucide-${rn(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=W("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=W("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=W("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=W("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=W("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=W("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=W("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=W("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=W("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=W("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=W("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=W("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),fn=1,gn=.5,hn="/models/mediapipe/selfie_multiclass_256x256.tflite",pn="/wasm/mediapipe";class mn{segmenter=null;isInitialized=!1;initializationPromise=null;confidenceThreshold=gn;async initialize(e=!0){if(this.isInitialized&&this.segmenter)return Promise.resolve();if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this._performInitialization(e);try{await this.initializationPromise,this.isInitialized=!0}catch(t){throw this.initializationPromise=null,t}return this.initializationPromise}async _performInitialization(e){try{console.log("[MediaPipe] Initializing vision tasks...");const t=await lr.forVisionTasks(pn);console.log("[MediaPipe] Creating ImageSegmenter..."),this.segmenter=await cr.createFromOptions(t,{baseOptions:{modelAssetPath:hn,delegate:e?"GPU":"CPU"},runningMode:"IMAGE",outputCategoryMask:!0,outputConfidenceMasks:!1}),console.log("[MediaPipe] Initialization complete",{delegate:e?"GPU":"CPU",model:"selfie_multiclass_256x256"})}catch(t){const r=t instanceof Error?t.message:"Unknown error";throw console.error("[MediaPipe] Initialization failed:",r),new Error(`Failed to initialize MediaPipe: ${r}`)}}async segmentImage(e,t){if(!this.isInitialized||!this.segmenter)throw new Error("MediaPipe service not initialized. Call initialize() first.");const r=performance.now();try{console.log("⚡ =========================================="),console.log("⚡ [MediaPipe] USING MediaPipe (Fast Mode)"),console.log("⚡ ==========================================");const s=this.segmenter.segment(e),i=this.extractHairMask(s),o=performance.now()-r,a=this._calculateConfidence(i);return console.log("[MediaPipe] Segmentation complete",{processingTime:`${o.toFixed(2)}ms`,confidence:`${(a*100).toFixed(1)}%`,maskSize:i.length}),{mask:i,width:s.categoryMask?.width||e.width,height:s.categoryMask?.height||e.height,confidence:a,processingTime:o,timestamp:Date.now()}}catch(s){const i=s instanceof Error?s.message:"Unknown error";throw console.error("[MediaPipe] Segmentation failed:",i),new Error(`Hair segmentation failed: ${i}`)}}extractHairMask(e){if(!e.categoryMask)throw new Error("Segmentation result missing category mask");const{width:t,height:r}=e.categoryMask,s=e.categoryMask.getAsUint8Array(),i=new Uint8Array(t*r);for(let o=0;o<s.length;o++)i[o]=s[o]===fn?255:0;return i}setConfidenceThreshold(e){if(e<0||e>1)throw new Error("Confidence threshold must be between 0 and 1");this.confidenceThreshold=e,console.log("[MediaPipe] Confidence threshold set to:",e)}getConfidenceThreshold(){return this.confidenceThreshold}_calculateConfidence(e){let t=0,r=e.length;for(let s=0;s<e.length;s++)e[s]===255&&t++;return t/r}isReady(){return this.isInitialized&&this.segmenter!==null}dispose(){this.segmenter&&(this.segmenter.close(),this.segmenter=null),this.isInitialized=!1,this.initializationPromise=null,console.log("[MediaPipe] Resources disposed")}}const ae=new mn,xn={enabled:!0,guidedFilter:{radius:8,epsilon:.01},edgeEnhancement:{enabled:!0,sigma:1,strength:.3},detailRecovery:{enabled:!0,highFreqWeight:.4,confidenceThreshold:.3,strandWidth:2}};class yn{config=xn;setConfig(e){this.config={...this.config,...e},console.log("[Refinement] Configuration updated:",this.config)}getConfig(){return{...this.config}}async refine(e,t,r,s){if(!this.config.enabled)return console.log("[Refinement] Refinement disabled, returning original alpha"),e;const i=performance.now();console.log("[Refinement] Starting refinement pipeline...");let o=new Float32Array(e);o=this.applyGuidedFilter(o,t,r,s),this.config.edgeEnhancement?.enabled&&(o=this.enhanceEdges(o,r,s)),this.config.detailRecovery?.enabled&&(o=this.recoverDetails(o,t,r,s));const a=performance.now()-i;return console.log("[Refinement] Refinement complete",{processingTime:`${a.toFixed(2)}ms`}),o}applyGuidedFilter(e,t,r,s){console.log("[Refinement] Applying guided filter...");const i=this.extractGrayscale(t,r,s),o=this.config.guidedFilter.radius,a=this.config.guidedFilter.epsilon,l=this.boxFilter(i,r,s,o),c=this.boxFilter(e,r,s,o),d=this.multiply(i,i,r,s),f=this.multiply(i,e,r,s),g=this.boxFilter(d,r,s,o),h=this.boxFilter(f,r,s,o),p=this.subtract(g,this.multiply(l,l,r,s),r,s),m=this.subtract(h,this.multiply(l,c,r,s),r,s),y=new Float32Array(r*s),w=new Float32Array(r*s);for(let b=0;b<r*s;b++)y[b]=m[b]/(p[b]+a),w[b]=c[b]-y[b]*l[b];const C=this.boxFilter(y,r,s,o),F=this.boxFilter(w,r,s,o),_=new Float32Array(r*s);for(let b=0;b<r*s;b++)_[b]=Math.max(0,Math.min(1,C[b]*i[b]+F[b]));return _}enhanceEdges(e,t,r){console.log("[Refinement] Enhancing edges...");const s=this.config.edgeEnhancement?.sigma??1,i=this.config.edgeEnhancement?.strength??.3,o=this.laplacianOfGaussian(e,t,r,s),a=new Float32Array(t*r);for(let l=0;l<t*r;l++)a[l]=Math.max(0,Math.min(1,e[l]+i*o[l]));return a}recoverDetails(e,t,r,s){console.log("[Refinement] Recovering fine details...");const i=this.extractGrayscale(t,r,s),o=this.gaussianBlur(i,r,s,2),a=this.subtract(i,o,r,s),l=this.config.detailRecovery?.strandWidth??2,c=this.detectThinStructures(a,r,s,l),d=new Float32Array(r*s),f=this.config.detailRecovery?.highFreqWeight??.4,g=this.config.detailRecovery?.confidenceThreshold??.3;for(let h=0;h<r*s;h++){const p=e[h],m=c[h],y=a[h];p>g&&m>.5?d[h]=Math.min(1,p+f*Math.abs(y)):d[h]=p}return d}morphologicalCleanup(e,t,r){const s=this.erode(e,t,r,1);return this.dilate(s,t,r,1)}extractGrayscale(e,t,r){const s=document.createElement("canvas");s.width=t,s.height=r;const i=s.getContext("2d");if(!i)throw new Error("Failed to get 2D context");i.drawImage(e,0,0,t,r);const a=i.getImageData(0,0,t,r).data,l=new Float32Array(t*r);for(let c=0;c<t*r;c++){const d=c*4;l[c]=(.299*a[d]+.587*a[d+1]+.114*a[d+2])/255}return l}boxFilter(e,t,r,s){const i=new Float32Array(t*r);for(let a=0;a<r;a++)for(let l=0;l<t;l++){let c=0,d=0;const f=Math.max(0,l-s),g=Math.min(t-1,l+s);for(let h=f;h<=g;h++)c+=e[a*t+h],d++;i[a*t+l]=c/d}const o=new Float32Array(t*r);for(let a=0;a<r;a++){const l=Math.max(0,a-s),c=Math.min(r-1,a+s);for(let d=0;d<t;d++){let f=0,g=0;for(let h=l;h<=c;h++)f+=i[h*t+d],g++;o[a*t+d]=f/g}}return o}gaussianBlur(e,t,r,s){const i=Math.ceil(3*s),o=2*i+1,a=new Float32Array(o);let l=0;for(let f=0;f<o;f++){const g=f-i;a[f]=Math.exp(-(g*g)/(2*s*s)),l+=a[f]}for(let f=0;f<o;f++)a[f]/=l;const c=new Float32Array(t*r);for(let f=0;f<r;f++)for(let g=0;g<t;g++){let h=0,p=0;for(let m=0;m<o;m++){const y=g+m-i;y>=0&&y<t&&(h+=e[f*t+y]*a[m],p+=a[m])}c[f*t+g]=p>0?h/p:0}const d=new Float32Array(t*r);for(let f=0;f<r;f++)for(let g=0;g<t;g++){let h=0,p=0;for(let m=0;m<o;m++){const y=f+m-i;y>=0&&y<r&&(h+=c[y*t+g]*a[m],p+=a[m])}d[f*t+g]=p>0?h/p:0}return d}laplacianOfGaussian(e,t,r,s){const i=this.gaussianBlur(e,t,r,s),o=new Float32Array(t*r);for(let a=1;a<r-1;a++)for(let l=1;l<t-1;l++){const c=a*t+l,d=-4*i[c]+i[c-1]+i[c+1]+i[(a-1)*t+l]+i[(a+1)*t+l];o[c]=d}return o}detectThinStructures(e,t,r,s){const i=new Float32Array(t*r);for(let o=0;o<t*r;o++)i[o]=Math.abs(e[o])>.1?1:0;return this.dilate(i,t,r,s)}erode(e,t,r,s){const i=new Float32Array(t*r);for(let o=0;o<r;o++)for(let a=0;a<t;a++){let l=1;for(let c=-s;c<=s;c++)for(let d=-s;d<=s;d++){const f=a+d,g=o+c;f>=0&&f<t&&g>=0&&g<r&&(l=Math.min(l,e[g*t+f]))}i[o*t+a]=l}return i}dilate(e,t,r,s){const i=new Float32Array(t*r);for(let o=0;o<r;o++)for(let a=0;a<t;a++){let l=0;for(let c=-s;c<=s;c++)for(let d=-s;d<=s;d++){const f=a+d,g=o+c;f>=0&&f<t&&g>=0&&g<r&&(l=Math.max(l,e[g*t+f]))}i[o*t+a]=l}return i}multiply(e,t,r,s){const i=new Float32Array(r*s);for(let o=0;o<r*s;o++)i[o]=e[o]*t[o];return i}subtract(e,t,r,s){const i=new Float32Array(r*s);for(let o=0;o<r*s;o++)i[o]=e[o]-t[o];return i}}const bn=new yn;Bt.allowLocalModels=!0;Bt.allowRemoteModels=!1;const vn="/models/modnet/";class wn{segmenter=null;isInitialized=!1;initializationPromise=null;async initialize(e=!0){if(this.isInitialized&&this.segmenter)return Promise.resolve();if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this._performInitialization(e);try{await this.initializationPromise,this.isInitialized=!0}catch(t){throw this.initializationPromise=null,t}return this.initializationPromise}async _performInitialization(e){try{console.log("[MODNet] Initializing Transformers.js pipeline...");const t=e?"webgpu":"wasm",r=vn;this.segmenter=await ur("background-removal",r,{dtype:"fp32",device:t}),console.log("[MODNet] Initialization complete",{device:t,model:"Xenova/modnet"})}catch(t){const r=t instanceof Error?t.message:"Unknown error";if(console.error("[MODNet] Initialization failed:",r),e&&r.includes("webgpu"))return console.log("[MODNet] WebGPU failed, falling back to WASM..."),this._performInitialization(!1);throw new Error(`Failed to initialize MODNet: ${r}`)}}async segmentImage(e){if(!this.isInitialized||!this.segmenter)throw new Error("MODNet service not initialized. Call initialize() first.");const t=performance.now();try{console.log("🎨 =========================================="),console.log("🎨 [MODNet] USING MODNet (High Quality Mode)"),console.log("🎨 =========================================="),console.log("[MODNet] Running segmentation...");const r=e instanceof HTMLImageElement?await lt.fromURL(e.src):await this._convertToRawImage(e),s=await this.segmenter(r);console.log("[MODNet] Segmenter output:",{outputType:s?.constructor?.name,isArray:Array.isArray(s),length:s?.length,keys:s?Object.keys(s).join(", "):"null",output0Type:s?.[0]?.constructor?.name,output0Keys:s?.[0]?Object.keys(s[0]).join(", "):"null"});const i=s[0],o=await this._extractAlphaChannel(i,e.width,e.height),a=this._convertUint8ToFloat32(o);console.log("✨ [MODNet] Applying optimized matting refinement pipeline...");const l=performance.now(),c=e instanceof HTMLImageElement?e:await this._convertElementToCanvas(e),d=await bn.refine(a,c,e.width,e.height),f=performance.now()-l;console.log(`✨ [MODNet] Refinement complete in ${f.toFixed(2)}ms`);const g=this._convertFloat32ToUint8(d),h=performance.now()-t,p=this._calculateConfidence(g);return console.log("[MODNet] Segmentation complete",{processingTime:`${h.toFixed(2)}ms`,confidence:`${(p*100).toFixed(1)}%`,maskSize:g.length}),{mask:g,width:e.width,height:e.height,confidence:p,processingTime:h,timestamp:Date.now()}}catch(r){const s=r instanceof Error?r.message:"Unknown error";throw console.error("[MODNet] Segmentation failed:",s),new Error(`Hair segmentation failed: ${s}`)}}async _convertElementToCanvas(e){if(e instanceof HTMLCanvasElement)return e;const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("Failed to get 2D context");const s=e.videoWidth,i=e.videoHeight;return t.width=s,t.height=i,r.drawImage(e,0,0,s,i),t}async _convertToRawImage(e){const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("Failed to get 2D context");const s="videoWidth"in e?e.videoWidth:e.width,i="videoHeight"in e?e.videoHeight:e.height;t.width=s,t.height=i,r.drawImage(e,0,0,s,i);const o=await new Promise(c=>{t.toBlob(d=>c(d),"image/png")}),a=URL.createObjectURL(o),l=await lt.fromURL(a);return URL.revokeObjectURL(a),l}async _extractAlphaAsFloat32(e,t,r){const o=(await e.resize(t,r)).toTensor().to("float32").data;return new Float32Array(o)}_convertUint8ToFloat32(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r]/255;return t}_convertFloat32ToUint8(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++){const s=Math.max(0,Math.min(1,e[r]));t[r]=Math.round(s*255)}return t}async _extractAlphaChannel(e,t,r){console.log("[MODNet] BEFORE resize:",{type:e?.constructor?.name,width:e.width,height:e.height,channels:e.channels,hasData:!!e.data,hasResize:typeof e.resize,keys:Object.keys(e).slice(0,20).join(", ")});const s=await e.resize(t,r);console.log("[MODNet] AFTER resize:",{type:s?.constructor?.name,width:s.width,height:s.height,channels:s.channels,dataType:s.data?.constructor?.name,dataLength:s.data?.length,hasToTensor:typeof s.toTensor,keys:Object.keys(s).slice(0,20).join(", ")});const i=s.data,o=s.channels;if(!i||i.length===0)throw console.error("[MODNet] RawImage.data is empty or undefined!"),new Error("Failed to extract alpha channel: data is empty");console.log("[MODNet] Extracted data:",{length:i.length,channels:o,expectedLength:t*r,firstFewValues:Array.from(i.slice(0,10))});const a=t*r,l=new Uint8Array(a);if(o===1)l.set(i.slice(0,a));else if(o===3||o===4)for(let p=0;p<a;p++)l[p]=i[p*o];else throw new Error(`Unexpected number of channels: ${o}`);let c=255,d=0,f=0,g=0,h=0;for(let p=0;p<l.length;p++){const m=l[p];m<c&&(c=m),m>d&&(d=m),f+=m,m>0&&g++,m===255&&h++}return console.log("[MODNet] Alpha channel extracted:",{outputLength:l.length,firstFewAlphaValues:Array.from(l.slice(0,10)),min:c,max:d,avg:f/l.length,nonZeroCount:g,fullWhiteCount:h,percentageNonZero:(g/l.length*100).toFixed(1)+"%"}),l}_calculateConfidence(e){let t=0;const r=127;for(let s=0;s<e.length;s++)e[s]>r&&t++;return t/e.length}isReady(){return this.isInitialized&&this.segmenter!==null}dispose(){this.segmenter&&(this.segmenter=null),this.isInitialized=!1,this.initializationPromise=null,console.log("[MODNet] Resources disposed")}}const le=new wn;class Sn{initialized=new Map;serverConfig=null;async initialize(e,t){if(this.initialized.get(e))return Promise.resolve();switch(console.log(`[Orchestrator] Initializing ${e} method...`),e){case"modnet":await ae.initialize(!0),await le.initialize(!0),this.initialized.set("modnet",!0);break;case"server":if(!t)throw new Error("Server configuration required for server-side segmentation");this.serverConfig=t,this.initialized.set("server",!0),console.log("[Orchestrator] Server-side segmentation configured");break;default:throw new Error(`Unknown segmentation method: ${e}`)}console.log(`[Orchestrator] ${e} method initialized successfully`)}async segment(e,t){switch(this.initialized.get(t)||await this.initialize(t),console.log(`[Orchestrator] Segmenting with ${t} method...`),t){case"modnet":return await this._twoStageSegmentation(e);case"server":return await this._segmentOnServer(e);default:throw new Error(`Unknown segmentation method: ${t}`)}}async _twoStageSegmentation(e){console.log("🎯 [Orchestrator] Two-stage segmentation: MediaPipe + MODNet");const t=performance.now();this.initialized.get("mediapipe")||(await ae.initialize(!0),this.initialized.set("mediapipe",!0)),this.initialized.get("modnet")||(await le.initialize(!0),this.initialized.set("modnet",!0)),console.log("🎯 Stage 1: MediaPipe semantic segmentation (hair identification)...");const s=(await ae.segmentImage(e)).mask;console.log("🎯 Stage 2: MODNet alpha matting (edge refinement)...");const o=(await le.segmentImage(e)).mask;console.log("🎯 Stage 3: Combining masks (hair × alpha)...");const a=new Uint8Array(s.length);for(let g=0;g<s.length;g++){const h=s[g]/255,p=o[g]/255;a[g]=Math.round(h*p*255)}const l=performance.now()-t;let c=0;const d=127;for(let g=0;g<a.length;g++)a[g]>d&&c++;const f=c/a.length;return console.log("🎯 [Orchestrator] Two-stage complete:",{processingTime:`${l.toFixed(2)}ms`,confidence:`${(f*100).toFixed(1)}%`,hairOnlyPixels:c}),{mask:a,width:e.width,height:e.height,confidence:f,processingTime:l,timestamp:Date.now()}}async _segmentOnServer(e){if(!this.serverConfig)throw new Error("Server-side segmentation not configured");return console.warn("[Orchestrator] Server-side segmentation is not yet implemented"),{mask:new Uint8Array(e.width*e.height).fill(0),width:e.width,height:e.height,confidence:0,processingTime:0,timestamp:Date.now()}}isReady(e){switch(e){case"modnet":return ae.isReady()&&le.isReady();case"server":return this.initialized.get("server")===!0;default:return!1}}getMethodName(e){switch(e){case"modnet":return"AI Segmentation (Recommended)";case"server":return"Server-side (Coming Soon)";default:return"Unknown"}}getMethodDescription(e){switch(e){case"modnet":return"Two-stage AI: MediaPipe (hair identification) + MODNet (alpha matting). Production quality using Google Pixel 6 approach.";case"server":return"Server-side processing for maximum quality (requires backend).";default:return""}}dispose(){console.log("[Orchestrator] Disposing all segmentation services..."),ae.dispose(),le.dispose(),this.initialized.clear(),this.serverConfig=null,console.log("[Orchestrator] All services disposed")}}const ce=new Sn,jt=n=>{let e;const t=new Set,r=(c,d)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const g=e;e=d??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(h=>h(e,g))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(r,s,a);return a},Cn=(n=>n?jt(n):jt),Nn=n=>n;function Rn(n,e=Nn){const t=fe.useSyncExternalStore(n.subscribe,fe.useCallback(()=>e(n.getState()),[n,e]),fe.useCallback(()=>e(n.getInitialState()),[n,e]));return fe.useDebugValue(t),t}const En=n=>{const e=Cn(n),t=r=>Rn(e,r);return Object.assign(t,e),t},Pn=(n=>En);var Zt=Symbol.for("immer-nothing"),_t=Symbol.for("immer-draftable"),G=Symbol.for("immer-state");function K(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var me=Object.getPrototypeOf;function se(n){return!!n&&!!n[G]}function Z(n){return n?Qt(n)||Array.isArray(n)||!!n[_t]||!!n.constructor?.[_t]||ve(n)||Fe(n):!1}var Ln=Object.prototype.constructor.toString(),Ot=new WeakMap;function Qt(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=Ot.get(t);return r===void 0&&(r=Function.toString.call(t),Ot.set(t,r)),r===Ln}function ke(n,e,t=!0){Te(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(s=>{e(s,n[s],n)}):n.forEach((r,s)=>e(s,r,n))}function Te(n){const e=n[G];return e?e.type_:Array.isArray(n)?1:ve(n)?2:Fe(n)?3:0}function Xe(n,e){return Te(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function er(n,e,t){const r=Te(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function kn(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function ve(n){return n instanceof Map}function Fe(n){return n instanceof Set}function Y(n){return n.copy_||n.base_}function Ye(n,e){if(ve(n))return new Map(n);if(Fe(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=Qt(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[G];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(me(n),r)}else{const r=me(n);if(r!==null&&t)return{...n};const s=Object.create(r);return Object.assign(s,n)}}function nt(n,e=!1){return Ie(n)||se(n)||!Z(n)||(Te(n)>1&&Object.defineProperties(n,{set:Re,add:Re,clear:Re,delete:Re}),Object.freeze(n),e&&Object.values(n).forEach(t=>nt(t,!0))),n}function jn(){K(2)}var Re={value:jn};function Ie(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var _n={};function Q(n){const e=_n[n];return e||K(0,n),e}var xe;function tr(){return xe}function On(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Tt(n,e){e&&(Q("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Je(n){Ze(n),n.drafts_.forEach(Tn),n.drafts_=null}function Ze(n){n===xe&&(xe=n.parent_)}function Ft(n){return xe=On(xe,n)}function Tn(n){const e=n[G];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function It(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[G].modified_&&(Je(e),K(4)),Z(n)&&(n=je(e,n),e.parent_||_e(e,n)),e.patches_&&Q("Patches").generateReplacementPatches_(t[G].base_,n,e.patches_,e.inversePatches_)):n=je(e,t,[]),Je(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==Zt?n:void 0}function je(n,e,t){if(Ie(e))return e;const r=n.immer_.shouldUseStrictIteration(),s=e[G];if(!s)return ke(e,(i,o)=>Mt(n,s,e,i,o,t),r),e;if(s.scope_!==n)return e;if(!s.modified_)return _e(n,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const i=s.copy_;let o=i,a=!1;s.type_===3&&(o=new Set(i),i.clear(),a=!0),ke(o,(l,c)=>Mt(n,s,i,l,c,t,a),r),_e(n,i,!1),t&&n.patches_&&Q("Patches").generatePatches_(s,t,n.patches_,n.inversePatches_)}return s.copy_}function Mt(n,e,t,r,s,i,o){if(s==null||typeof s!="object"&&!o)return;const a=Ie(s);if(!(a&&!o)){if(se(s)){const l=i&&e&&e.type_!==3&&!Xe(e.assigned_,r)?i.concat(r):void 0,c=je(n,s,l);if(er(t,r,c),se(c))n.canAutoFreeze_=!1;else return}else o&&t.add(s);if(Z(s)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===s&&a)return;je(n,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(ve(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&_e(n,s)}}}function _e(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&nt(e,t)}function Fn(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:tr(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=st;t&&(s=[r],i=ye);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return r.draft_=a,r.revoke_=o,a}var st={get(n,e){if(e===G)return n;const t=Y(n);if(!Xe(t,e))return In(n,t,e);const r=t[e];return n.finalized_||!Z(r)?r:r===Ue(n.base_,e)?(Be(n),n.copy_[e]=et(r,n)):r},has(n,e){return e in Y(n)},ownKeys(n){return Reflect.ownKeys(Y(n))},set(n,e,t){const r=rr(Y(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const s=Ue(Y(n),e),i=s?.[G];if(i&&i.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(kn(t,s)&&(t!==void 0||Xe(n.base_,e)))return!0;Be(n),Qe(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return Ue(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,Be(n),Qe(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Y(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){K(11)},getPrototypeOf(n){return me(n.base_)},setPrototypeOf(){K(12)}},ye={};ke(st,(n,e)=>{ye[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ye.deleteProperty=function(n,e){return ye.set.call(this,n,e,void 0)};ye.set=function(n,e,t){return st.set.call(this,n[0],e,t,n[0])};function Ue(n,e){const t=n[G];return(t?Y(t):n)[e]}function In(n,e,t){const r=rr(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function rr(n,e){if(!(e in n))return;let t=me(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=me(t)}}function Qe(n){n.modified_||(n.modified_=!0,n.parent_&&Qe(n.parent_))}function Be(n){n.copy_||(n.copy_=Ye(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Mn=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const o=this;return function(l=i,...c){return o.produce(l,d=>t.call(this,d,...c))}}typeof t!="function"&&K(6),r!==void 0&&typeof r!="function"&&K(7);let s;if(Z(e)){const i=Ft(this),o=et(e,void 0);let a=!0;try{s=t(o),a=!1}finally{a?Je(i):Ze(i)}return Tt(i,r),It(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===Zt&&(s=void 0),this.autoFreeze_&&nt(s,!0),r){const i=[],o=[];Q("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else K(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,s;return[this.produce(e,t,(o,a)=>{r=o,s=a}),r,s]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){Z(n)||K(8),se(n)&&(n=An(n));const e=Ft(this),t=et(n,void 0);return t[G].isManual_=!0,Ze(e),t}finishDraft(n,e){const t=n&&n[G];(!t||!t.isManual_)&&K(9);const{scope_:r}=t;return Tt(r,e),It(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}t>-1&&(e=e.slice(t+1));const r=Q("Patches").applyPatches_;return se(n)?r(n,e):this.produce(n,s=>r(s,e))}};function et(n,e){const t=ve(n)?Q("MapSet").proxyMap_(n,e):Fe(n)?Q("MapSet").proxySet_(n,e):Fn(n,e);return(e?e.scope_:tr()).drafts_.push(t),t}function An(n){return se(n)||K(10,n),nr(n)}function nr(n){if(!Z(n)||Ie(n))return n;const e=n[G];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Ye(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=Ye(n,!0);return ke(t,(s,i)=>{er(t,s,nr(i))},r),e&&(e.finalized_=!1),t}var Dn=new Mn,$n=Dn.produce;const zn=n=>(e,t,r)=>(r.setState=(s,i,...o)=>{const a=typeof s=="function"?$n(s):s;return e(a,i,...o)},n(r.setState,t,r)),Un=zn,Bn={opacity:.7,blendMode:"multi-layer",preserveLuminosity:!0,confidenceThreshold:.5},At={isActive:!1,tool:"brush",brushSize:20,history:[],historyIndex:-1},Hn={fps:0,segmentationTime:0,renderTime:0,totalTime:0},Gn=()=>{const n=localStorage.getItem("language");return n==="zh-CN"||n==="en"?n:"zh-CN"},H=Pn()(Un(n=>({view:"home",inputMode:"model",language:Gn(),currentImage:null,modelImages:[],userImages:[],segmentationMethod:"modnet",segmentationStatus:"idle",currentMask:null,selectedColor:null,colorSettings:Bn,maskEditor:At,metrics:Hn,actualFPS:0,error:null,setView:e=>n(t=>{t.view=e}),setInputMode:e=>n(t=>{t.inputMode=e}),setLanguage:e=>n(t=>{t.language=e,localStorage.setItem("language",e)}),setCurrentImage:e=>n(t=>{t.currentImage=e,t.currentMask=null,t.maskEditor=At}),addUserImage:e=>n(t=>{t.userImages=[...t.userImages,e]}),setSegmentationMethod:e=>n(t=>{t.segmentationMethod=e}),setSegmentationStatus:e=>n(t=>{t.segmentationStatus=e}),setCurrentMask:e=>n(t=>{t.currentMask=e}),setSelectedColor:e=>n(t=>{t.selectedColor=e}),updateColorSettings:e=>n(t=>{t.colorSettings={...t.colorSettings,...e}}),updateMaskEditor:e=>n(t=>{t.maskEditor={...t.maskEditor,...e}}),updateMetrics:e=>n(t=>{t.metrics={...t.metrics,...e}}),setActualFPS:e=>n(t=>{t.actualFPS=e}),setError:e=>n(t=>{t.error=e}),clearError:()=>n(e=>{e.error=null})}))),Vn=()=>H(n=>n.language),sr=()=>H(n=>n.segmentationMethod);function ir(){const[n,e]=x.useState(!1),[t,r]=x.useState(null),[s,i]=x.useState(!1),o=x.useRef(!1),a=sr(),l=H(g=>g.setSegmentationStatus),c=H(g=>g.setError);x.useEffect(()=>{(async()=>{if(!o.current){if(ce.isReady(a)){console.log(`[useSegmentation] ${a} already initialized`),e(!0),l("ready");return}o.current=!0;try{console.log(`[useSegmentation] Initializing ${a}...`),l("loading"),e(!1),await ce.initialize(a),e(!0),r(null),l("ready"),console.log(`[useSegmentation] ${a} ready`)}catch(h){const p=h instanceof Error?h.message:`Failed to initialize ${a}`;console.error("[useSegmentation] Initialization error:",p),r(p),e(!1),l("error"),c({code:"SEGMENTATION_INIT_FAILED",message:`Failed to load ${a} segmentation`,details:p,timestamp:Date.now()})}finally{o.current=!1}}})()},[a,l,c]);const d=x.useCallback(async g=>{if(!n)return console.warn(`[useSegmentation] ${a} not ready, cannot segment`),null;try{i(!0),l("segmenting");const h=await ce.segment(g,a);return l("ready"),h}catch(h){const p=h instanceof Error?h.message:"Segmentation failed";return console.error("[useSegmentation] Segmentation error:",p),l("error"),c({code:"SEGMENTATION_FAILED",message:"Unable to detect hair in the image",details:p,timestamp:Date.now()}),null}finally{i(!1)}},[n,a,l,c]),f=x.useCallback(async()=>{console.log(`[useSegmentation] Re-initializing ${a}...`),ce.dispose(),e(!1),r(null),i(!1),o.current=!1;try{l("loading"),await ce.initialize(a),e(!0),r(null),l("ready"),console.log("[useSegmentation] Re-initialization successful")}catch(g){const h=g instanceof Error?g.message:"Re-initialization failed";console.error("[useSegmentation] Re-initialization error:",h),r(h),e(!1),l("error"),c({code:"SEGMENTATION_REINIT_FAILED",message:`Failed to restart ${a} segmentation`,details:h,timestamp:Date.now()})}},[a,l,c]);return{isReady:n,error:t,isSegmenting:s,segment:d,reinitialize:f,currentMethod:a}}const Dt=["image/jpeg","image/png","image/webp"],Wn=10*1024*1024,Kn=["jpg","jpeg","png","webp"];function qn({onImageProcessed:n,className:e=""}){const{t,ready:r}=be(),[s,i]=x.useState(!1),[o,a]=x.useState(!1),[l,c]=x.useState(null),[d,f]=x.useState(null),g=x.useRef(null),{isReady:h,error:p,segment:m,currentMethod:y}=ir(),{setCurrentImage:w,setCurrentMask:C,addUserImage:F}=H();if(!r)return u.jsx("div",{className:e,children:"Loading..."});const _=v=>{if(!Dt.includes(v.type)){const k=v.name.split(".").pop()?.toLowerCase();if(!k||!Kn.includes(k))return{valid:!1,error:t("upload.invalidFileType")}}if(v.size>Wn){const k=(v.size/1048576).toFixed(2);return{valid:!1,error:t("upload.fileTooLarge",{size:k})}}return{valid:!0}},b=x.useCallback(async v=>{const k=_(v);if(!k.valid){c(k.error||"Invalid file");return}c(null),a(!0);try{const T=new FileReader;T.onload=async D=>{const I=D.target?.result;f(I);const M=new Image;M.onload=async()=>{if(console.log("[ImageUploader] Image loaded:",{width:M.width,height:M.height,size:`${(v.size/1024).toFixed(2)}KB`}),w({element:M,url:I,width:M.width,height:M.height,source:"upload"}),F({id:`upload-${Date.now()}`,url:I,element:M,uploadedAt:Date.now()}),h){console.log(`[ImageUploader] Starting hair segmentation using ${y}...`);const A=await m(M);A?(console.log("[ImageUploader] Segmentation complete:",{confidence:`${(A.confidence*100).toFixed(1)}%`,processingTime:`${A.processingTime.toFixed(2)}ms`}),C({data:A.mask,width:A.width,height:A.height,confidence:A.confidence,source:"ai"}),n&&n(M,A.mask)):console.warn("[ImageUploader] Segmentation returned null")}else console.warn(`[ImageUploader] ${y} not ready, skipping segmentation`);a(!1)},M.onerror=()=>{c(t("upload.failedToLoad")),a(!1)},M.src=I},T.onerror=()=>{c(t("upload.failedToRead")),a(!1)},T.readAsDataURL(v)}catch(T){const D=T instanceof Error?T.message:"Unknown error";c(`Error processing file: ${D}`),a(!1)}},[h,m,w,C,F,n]),O=x.useCallback(v=>{const k=v.target.files?.[0];k&&b(k)},[b]),R=x.useCallback(v=>{v.preventDefault(),v.stopPropagation(),i(!0)},[]),E=x.useCallback(v=>{v.preventDefault(),v.stopPropagation(),i(!1)},[]),N=x.useCallback(v=>{v.preventDefault(),v.stopPropagation(),i(!1);const k=v.dataTransfer.files[0];k&&b(k)},[b]),P=x.useCallback(()=>{g.current?.click()},[]),L=l||p,V=o||!h;return u.jsxs("div",{className:`w-full ${e}`,children:[u.jsxs("div",{onClick:P,onDragOver:R,onDragLeave:E,onDrop:N,className:`
          relative flex flex-col items-center justify-center
          min-h-64 p-8 rounded-lg border-2 border-dashed
          transition-all duration-200 cursor-pointer
          ${s?"border-primary bg-primary/5 scale-[1.02]":"border-muted-foreground/25 hover:border-primary/50 hover:bg-muted/50"}
          ${L?"border-destructive/50 bg-destructive/5":""}
          ${o?"cursor-wait":"cursor-pointer"}
        `,children:[u.jsx("input",{ref:g,type:"file",accept:Dt.join(","),onChange:O,className:"hidden",disabled:o}),u.jsx("div",{className:"mb-4",children:d?u.jsx(qe,{className:"w-12 h-12 text-primary"}):u.jsx(Yt,{className:`w-12 h-12 ${s?"text-primary animate-bounce":"text-muted-foreground"}`})}),u.jsx("div",{className:"text-center",children:o?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-lg font-medium mb-2",children:t("upload.processing")}),u.jsx("p",{className:"text-sm text-muted-foreground",children:t("upload.detecting")})]}):h?d?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-lg font-medium mb-2",children:t("upload.uploaded")}),u.jsx("p",{className:"text-sm text-muted-foreground",children:t("upload.uploadDifferent")})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-lg font-medium mb-2",children:t(s?"upload.dropHere":"upload.uploadYourPhoto")}),u.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:t("upload.dragAndDrop")}),u.jsx("p",{className:"text-xs text-muted-foreground",children:t("upload.supported")})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-lg font-medium mb-2",children:t("upload.loadingModel")}),u.jsx("p",{className:"text-sm text-muted-foreground",children:t("upload.pleaseWait")})]})}),V&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 rounded-lg",children:u.jsx("div",{className:"w-8 h-8 border-4 border-primary/30 border-t-primary rounded-full animate-spin"})}),d&&!o&&u.jsx("div",{className:"mt-4 max-w-xs",children:u.jsx("img",{src:d,alt:"Preview",className:"rounded-lg shadow-md max-h-32 object-cover"})})]}),L&&u.jsxs("div",{className:"mt-4 p-4 rounded-lg bg-destructive/10 border border-destructive/30 flex items-start gap-3",children:[u.jsx(rt,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-destructive",children:t("upload.error")}),u.jsx("p",{className:"text-sm text-destructive/80 mt-1",children:L})]})]}),u.jsxs("div",{className:"mt-4 text-xs text-muted-foreground space-y-1",children:[u.jsx("p",{className:"font-medium",children:t("upload.requirements")}),u.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-2",children:[u.jsx("li",{children:t("upload.clearPhoto")}),u.jsx("li",{children:t("upload.hairVisible")}),u.jsx("li",{children:t("upload.frontFacing")}),u.jsx("li",{children:t("upload.plainBackground")})]})]})]})}const Xn={video:{width:{ideal:1280},height:{ideal:720},facingMode:"user",frameRate:{ideal:30,max:60}},audio:!1},ue=640,de=480,Yn=30,Jn=10;function Zn({applyColor:n=!0,onCameraStart:e,onCameraStop:t,className:r=""}){const[s,i]=x.useState(!1),[o,a]=x.useState(null),[l,c]=x.useState(0),[d,f]=x.useState(!1),g=x.useRef(null),h=x.useRef(null),p=x.useRef(null),m=x.useRef(null),y=x.useRef([]),w=x.useRef(0),{isReady:C,segment:F,currentMethod:_}=ir(),{selectedColor:b,setActualFPS:O}=H(),R=x.useCallback(async()=>{try{console.log("[CameraCapture] Requesting camera access..."),a(null),f(!1);const L=await navigator.mediaDevices.getUserMedia(Xn);p.current=L,console.log("[CameraCapture] Camera access granted",{tracks:L.getVideoTracks().length,settings:L.getVideoTracks()[0]?.getSettings()}),g.current&&(g.current.srcObject=L,await g.current.play(),i(!0),a(null),e?.(),console.log("[CameraCapture] Camera started"))}catch(L){const V=L instanceof Error?L.message:"Unknown error";console.error("[CameraCapture] Camera access failed:",V),L instanceof DOMException&&L.name==="NotAllowedError"?(f(!0),a("Camera permission denied. Please allow camera access in your browser settings.")):L instanceof DOMException&&L.name==="NotFoundError"?a("No camera found. Please connect a camera and try again."):a(`Failed to access camera: ${V}`),i(!1)}},[e]),E=x.useCallback(()=>{console.log("[CameraCapture] Stopping camera..."),p.current&&(p.current.getTracks().forEach(L=>{L.stop(),console.log("[CameraCapture] Track stopped:",L.kind)}),p.current=null),g.current&&(g.current.srcObject=null),m.current&&(cancelAnimationFrame(m.current),m.current=null),i(!1),c(0),O(0),y.current=[],t?.(),console.log("[CameraCapture] Camera stopped")},[t,O]),N=x.useCallback(async()=>{if(!s||!g.current||!h.current||!C)return;const L=g.current,v=h.current.getContext("2d");if(!v||L.readyState!==L.HAVE_ENOUGH_DATA){m.current=requestAnimationFrame(N);return}const k=performance.now();try{const T=performance.now();if(y.current.push(T),y.current.length>Yn&&y.current.shift(),y.current.length>=2){const A=T-y.current[0],z=Math.round(y.current.length/A*1e3);c(z),O(z)}const D=T-w.current;if(l>0&&l<Jn&&D<100){m.current=requestAnimationFrame(N);return}w.current=T,v.drawImage(L,0,0,ue,de);const I=await F(L);if(I&&n&&b){const A=v.getImageData(0,0,ue,de),z=A.data,$=I.mask,B=b.rgb.r,q=b.rgb.g,we=b.rgb.b,ee=b.opacity||.7;for(let Se=0;Se<$.length;Se++)if($[Se]===255){const te=Se*4,it=z[te],ot=z[te+1],at=z[te+2];z[te]=it*(1-ee)+it*B/255*ee,z[te+1]=ot*(1-ee)+ot*q/255*ee,z[te+2]=at*(1-ee)+at*we/255*ee}v.putImageData(A,0,0)}else if(I&&!b){const A=v.getImageData(0,0,ue,de),z=A.data,$=I.mask;for(let B=0;B<$.length;B++)if($[B]===255){const q=B*4;z[q+1]=Math.min(255,z[q+1]+50)}v.putImageData(A,0,0)}const M=performance.now()-k;console.log(`[CameraCapture] Frame processed in ${M.toFixed(2)}ms`)}catch(T){console.error("[CameraCapture] Frame processing error:",T)}m.current=requestAnimationFrame(N)},[s,C,F,b,n,l,O]);x.useEffect(()=>(s&&C&&!m.current&&(console.log("[CameraCapture] Starting frame processing loop..."),m.current=requestAnimationFrame(N)),()=>{m.current&&(cancelAnimationFrame(m.current),m.current=null)}),[s,C,N]),x.useEffect(()=>()=>{E()},[E]);const P=x.useCallback(()=>{s?E():R()},[s,R,E]);return u.jsxs("div",{className:`w-full ${r}`,children:[u.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-muted",children:[u.jsx("video",{ref:g,className:"hidden",playsInline:!0,muted:!0,autoPlay:!0}),u.jsx("canvas",{ref:h,width:ue,height:de,className:`w-full h-auto ${s?"block":"hidden"}`}),!s&&u.jsx("div",{className:"aspect-video flex items-center justify-center bg-muted",children:u.jsxs("div",{className:"text-center",children:[u.jsx(kt,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),u.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Camera Off"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "Start Camera" to begin'})]})}),s&&u.jsxs("div",{className:"absolute top-4 right-4 px-3 py-1.5 rounded-md bg-black/60 backdrop-blur-sm text-white text-sm font-mono",children:[l," FPS"]}),s&&u.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 px-3 py-1.5 rounded-md bg-black/60 backdrop-blur-sm text-white text-sm",children:[u.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),u.jsx("span",{children:"Live"})]}),!C&&s&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:u.jsxs("div",{className:"text-center text-white",children:[u.jsx("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-3"}),u.jsxs("p",{className:"text-sm",children:["Loading ",_," model..."]})]})})]}),u.jsx("div",{className:"mt-4 flex items-center justify-center gap-4",children:u.jsx("button",{onClick:P,disabled:!C,className:`
            flex items-center gap-2 px-6 py-3 rounded-lg font-medium
            transition-all duration-200
            ${s?"bg-destructive hover:bg-destructive/90 text-destructive-foreground":"bg-primary hover:bg-primary/90 text-primary-foreground"}
            disabled:opacity-50 disabled:cursor-not-allowed
          `,children:s?u.jsxs(u.Fragment,{children:[u.jsx(kt,{className:"w-5 h-5"}),u.jsx("span",{children:"Stop Camera"})]}):u.jsxs(u.Fragment,{children:[u.jsx(Ke,{className:"w-5 h-5"}),u.jsx("span",{children:"Start Camera"})]})})}),o&&u.jsxs("div",{className:"mt-4 p-4 rounded-lg bg-destructive/10 border border-destructive/30 flex items-start gap-3",children:[u.jsx(rt,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-destructive",children:"Camera Error"}),u.jsx("p",{className:"text-sm text-destructive/80 mt-1",children:o}),d&&u.jsx("p",{className:"text-xs text-destructive/70 mt-2",children:"On mobile: Check Settings → Safari → Camera. On desktop: Click the camera icon in your browser's address bar."})]})]}),s&&l>0&&u.jsx("div",{className:"mt-4 text-xs text-muted-foreground text-center",children:u.jsxs("p",{children:["Performance: ",l>=20?"✅ Excellent":l>=15?"⚠️ Good":"❌ Poor"," • ","Processing at ",ue,"x",de]})}),!s&&!o&&u.jsxs("div",{className:"mt-4 text-xs text-muted-foreground space-y-1",children:[u.jsx("p",{className:"font-medium",children:"Tips for best results:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-2",children:[u.jsx("li",{children:"Use good lighting (face the light source)"}),u.jsx("li",{children:"Keep your face centered in frame"}),u.jsx("li",{children:"Avoid rapid movements for better processing"}),u.jsx("li",{children:"Try different angles to see how colors look"})]})]})]})}const Qn=`
  attribute vec2 a_position;
  attribute vec2 a_texCoord;

  varying vec2 v_texCoord;

  void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);
    v_texCoord = a_texCoord;
  }
`,es=`
  precision mediump float;

  // Textures
  uniform sampler2D u_image;
  uniform sampler2D u_hairMask;

  // Color parameters
  uniform vec3 u_targetColor;
  uniform float u_opacity;
  uniform bool u_multiLayer;
  uniform float u_edgeFeathering;

  // Texture coordinates
  varying vec2 v_texCoord;

  // RGB to HSL conversion
  vec3 rgb2hsl(vec3 rgb) {
    float maxC = max(max(rgb.r, rgb.g), rgb.b);
    float minC = min(min(rgb.r, rgb.g), rgb.b);
    float delta = maxC - minC;

    float l = (maxC + minC) / 2.0;

    if (delta == 0.0) {
      return vec3(0.0, 0.0, l);
    }

    float s = l < 0.5 ? delta / (maxC + minC) : delta / (2.0 - maxC - minC);

    float h;
    if (maxC == rgb.r) {
      h = (rgb.g - rgb.b) / delta + (rgb.g < rgb.b ? 6.0 : 0.0);
    } else if (maxC == rgb.g) {
      h = (rgb.b - rgb.r) / delta + 2.0;
    } else {
      h = (rgb.r - rgb.g) / delta + 4.0;
    }
    h /= 6.0;

    return vec3(h, s, l);
  }

  // Helper function for hue to RGB conversion
  float hue2rgb(float p, float q, float t) {
    if (t < 0.0) t += 1.0;
    if (t > 1.0) t -= 1.0;
    if (t < 1.0 / 6.0) return p + (q - p) * 6.0 * t;
    if (t < 1.0 / 2.0) return q;
    if (t < 2.0 / 3.0) return p + (q - p) * (2.0 / 3.0 - t) * 6.0;
    return p;
  }

  // HSL to RGB conversion
  vec3 hsl2rgb(vec3 hsl) {
    float h = hsl.x;
    float s = hsl.y;
    float l = hsl.z;

    if (s == 0.0) {
      return vec3(l);
    }

    float q = l < 0.5 ? l * (1.0 + s) : l + s - l * s;
    float p = 2.0 * l - q;

    return vec3(
      hue2rgb(p, q, h + 1.0 / 3.0),
      hue2rgb(p, q, h),
      hue2rgb(p, q, h - 1.0 / 3.0)
    );
  }

  // Gaussian blur approximation for edge feathering
  float gaussianBlur(sampler2D tex, vec2 coord, float radius) {
    float sigma = radius / 2.0;
    float total = 0.0;
    float weightSum = 0.0;

    // 3x3 kernel approximation
    for (float x = -1.0; x <= 1.0; x += 1.0) {
      for (float y = -1.0; y <= 1.0; y += 1.0) {
        vec2 offset = vec2(x, y) * radius;
        float weight = exp(-(x * x + y * y) / (2.0 * sigma * sigma));
        total += texture2D(tex, coord + offset).r * weight;
        weightSum += weight;
      }
    }

    return total / weightSum;
  }

  // Multi-layer hair color blending
  vec3 multiLayerBlend(vec3 originalRGB, vec3 targetRGB, float luminosity, float maskValue) {
    // Separate into zones based on luminosity
    float highlightZone = smoothstep(0.6, 0.8, luminosity);
    float midtoneZone = 1.0 - abs(luminosity - 0.5) * 2.0;
    float shadowZone = smoothstep(0.4, 0.2, luminosity);

    // Convert target color to HSL
    vec3 targetHSL = rgb2hsl(targetRGB);

    // Base color: Use target hue/saturation, preserve original luminosity
    vec3 baseHSL = vec3(targetHSL.x, targetHSL.y, luminosity);
    vec3 baseColor = hsl2rgb(baseHSL);

    // Highlights: Blend less to preserve shine
    vec3 highlightColor = mix(baseColor, originalRGB, highlightZone * 0.4);

    // Shadows: Darken slightly to preserve depth
    vec3 shadowColor = baseColor * (1.0 - shadowZone * 0.2);

    // Midtones: Full color application
    vec3 midtoneColor = baseColor;

    // Composite layers
    vec3 result = highlightColor * highlightZone
                + midtoneColor * midtoneZone
                + shadowColor * shadowZone;

    // Normalize if zones don't sum to 1
    float totalZone = highlightZone + midtoneZone + shadowZone;
    if (totalZone > 0.0) {
      result /= totalZone;
    }

    return result;
  }

  void main() {
    // Sample original pixel and mask value
    vec4 originalColor = texture2D(u_image, v_texCoord);
    float maskValue = texture2D(u_hairMask, v_texCoord).r;

    // Apply edge feathering to mask
    if (u_edgeFeathering > 0.0) {
      maskValue = gaussianBlur(u_hairMask, v_texCoord, u_edgeFeathering / 1000.0);
    }

    // If not hair, return original color
    if (maskValue < 0.1) {
      gl_FragColor = originalColor;
      return;
    }

    vec3 blendedColor;

    if (u_multiLayer) {
      // Advanced multi-layer blending
      vec3 originalHSL = rgb2hsl(originalColor.rgb);
      float luminosity = originalHSL.z;

      blendedColor = multiLayerBlend(
        originalColor.rgb,
        u_targetColor,
        luminosity,
        maskValue
      );
    } else {
      // Simple HSL blending (preserves luminosity only)
      vec3 originalHSL = rgb2hsl(originalColor.rgb);
      vec3 targetHSL = rgb2hsl(u_targetColor);

      vec3 blendedHSL = vec3(
        targetHSL.x,
        mix(originalHSL.y, targetHSL.y, u_opacity),
        originalHSL.z  // Preserve original luminosity
      );

      blendedColor = hsl2rgb(blendedHSL);
    }

    // Apply mask with opacity
    vec3 finalColor = mix(
      originalColor.rgb,
      blendedColor,
      maskValue * u_opacity
    );

    gl_FragColor = vec4(finalColor, originalColor.a);
  }
`;class ts{gl=null;program=null;textures=new Map;initialized=!1;locations=null;constructor(e){if(this.gl=e.getContext("webgl2",{preserveDrawingBuffer:!0})||e.getContext("webgl",{preserveDrawingBuffer:!0}),!this.gl)throw new Error("WebGL not supported in this browser");console.log("[WebGLRenderer] Initializing...",{version:this.gl instanceof WebGL2RenderingContext?"WebGL2":"WebGL1",vendor:this.gl.getParameter(this.gl.VENDOR),renderer:this.gl.getParameter(this.gl.RENDERER)});try{this.initializeProgram(),this.setupVertexBuffer(),this.initialized=!0,console.log("[WebGLRenderer] Initialization complete")}catch(t){throw console.error("[WebGLRenderer] Initialization failed:",t),t}}initializeProgram(){if(!this.gl)throw new Error("WebGL context not available");const e=this.compileShader(this.gl.VERTEX_SHADER,Qn),t=this.compileShader(this.gl.FRAGMENT_SHADER,es);this.program=this.createProgram(e,t);const r=this.gl.getAttribLocation(this.program,"a_position"),s=this.gl.getAttribLocation(this.program,"a_texCoord"),i=this.gl.getUniformLocation(this.program,"u_image"),o=this.gl.getUniformLocation(this.program,"u_hairMask"),a=this.gl.getUniformLocation(this.program,"u_targetColor"),l=this.gl.getUniformLocation(this.program,"u_opacity"),c=this.gl.getUniformLocation(this.program,"u_multiLayer"),d=this.gl.getUniformLocation(this.program,"u_edgeFeathering");this.locations={attributes:{position:r,texCoord:s},uniforms:{image:i,hairMask:o,targetColor:a,opacity:l,multiLayer:c,edgeFeathering:d}},this.gl.useProgram(this.program)}compileShader(e,t){if(!this.gl)throw new Error("WebGL context not available");const r=this.gl.createShader(e);if(!r)throw new Error("Failed to create shader");if(this.gl.shaderSource(r,t),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){const s=this.gl.getShaderInfoLog(r);throw this.gl.deleteShader(r),new Error(`Shader compilation failed: ${s}`)}return r}createProgram(e,t){if(!this.gl)throw new Error("WebGL context not available");const r=this.gl.createProgram();if(!r)throw new Error("Failed to create program");if(this.gl.attachShader(r,e),this.gl.attachShader(r,t),this.gl.linkProgram(r),!this.gl.getProgramParameter(r,this.gl.LINK_STATUS)){const s=this.gl.getProgramInfoLog(r);throw this.gl.deleteProgram(r),new Error(`Program linking failed: ${s}`)}return r}setupVertexBuffer(){if(!this.gl||!this.locations)throw new Error("WebGL not initialized");const e=new Float32Array([-1,-1,1,-1,-1,1,1,1]),t=new Float32Array([0,1,1,1,0,0,1,0]),r=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.locations.attributes.position),this.gl.vertexAttribPointer(this.locations.attributes.position,2,this.gl.FLOAT,!1,0,0);const s=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.locations.attributes.texCoord),this.gl.vertexAttribPointer(this.locations.attributes.texCoord,2,this.gl.FLOAT,!1,0,0)}uploadTexture(e,t){if(!this.gl)throw new Error("WebGL context not available");let r=this.textures.get(e);if(!r){if(r=this.gl.createTexture(),!r)throw new Error("Failed to create texture");this.textures.set(e,r)}return this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),r}uploadMaskTexture(e,t,r,s){if(!this.gl)throw new Error("WebGL context not available");let i=this.textures.get(e);if(!i){if(i=this.gl.createTexture(),!i)throw new Error("Failed to create texture");this.textures.set(e,i)}return this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,r,s,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,t),i}render(e,t,r,s,i){if(!this.gl||!this.initialized||!this.locations)throw new Error("WebGL renderer not initialized");const o=performance.now();try{this.uploadTexture("source",e),this.uploadMaskTexture("mask",t,r,s),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures.get("source")),this.gl.uniform1i(this.locations.uniforms.image,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures.get("mask")),this.gl.uniform1i(this.locations.uniforms.hairMask,1);const a=i.targetColor.r/255,l=i.targetColor.g/255,c=i.targetColor.b/255;this.gl.uniform3f(this.locations.uniforms.targetColor,a,l,c),this.gl.uniform1f(this.locations.uniforms.opacity,i.opacity),this.gl.uniform1i(this.locations.uniforms.multiLayer,i.multiLayer?1:0),this.gl.uniform1f(this.locations.uniforms.edgeFeathering,i.edgeFeathering||2),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const d=performance.now()-o;console.log(`[WebGLRenderer] Rendered in ${d.toFixed(2)}ms`)}catch(a){throw console.error("[WebGLRenderer] Render error:",a),a}}dispose(){this.gl&&(console.log("[WebGLRenderer] Disposing resources..."),this.textures.forEach(e=>{this.gl?.deleteTexture(e)}),this.textures.clear(),this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.initialized=!1,this.locations=null,console.log("[WebGLRenderer] Resources disposed"))}}function rs({sourceImage:n,hairMask:e,maskWidth:t,maskHeight:r,className:s="",onRenderComplete:i}){const[o,a]=x.useState(null),[l,c]=x.useState(!1),[d,f]=x.useState(!0),g=x.useRef(null),h=x.useRef(null),p=x.useRef(0),m=H(w=>w.selectedColor),y=H(w=>w.colorSettings);return x.useEffect(()=>{if(g.current){try{console.log("[PreviewCanvas] Initializing WebGL renderer..."),h.current=new ts(g.current),f(!0),a(null)}catch(w){const C=w instanceof Error?w.message:"Unknown error";console.error("[PreviewCanvas] WebGL initialization failed:",C),f(!1),a(`WebGL not available: ${C}`)}return()=>{h.current&&(h.current.dispose(),h.current=null)}}},[]),x.useEffect(()=>{if(!n||!e||!m||!g.current)return;const w=t||n.width,C=r||n.height;(g.current.width!==n.width||g.current.height!==n.height)&&(g.current.width=n.width,g.current.height=n.height),(async()=>{c(!0);const _=performance.now();try{if(h.current&&d){const O={targetColor:m.rgb,opacity:y.opacity,multiLayer:y.blendMode==="multi-layer",edgeFeathering:2};h.current.render(n,e,w,C,O)}else{const O=g.current;if(!O)return;const R=O.getContext("2d");if(!R)return;R.drawImage(n,0,0);const E=R.getImageData(0,0,O.width,O.height),N=E.data,P=m.rgb.r,L=m.rgb.g,V=m.rgb.b,v=y.opacity;for(let k=0;k<e.length;k++)if(e[k]===255){const T=k*4,D=N[T],I=N[T+1],M=N[T+2];N[T]=D*(1-v)+D*P/255*v,N[T+1]=I*(1-v)+I*L/255*v,N[T+2]=M*(1-v)+M*V/255*v}R.putImageData(E,0,0)}const b=performance.now()-_;p.current=b,console.log("[PreviewCanvas] Render complete",{mode:d?"WebGL":"Canvas2D",time:`${b.toFixed(2)}ms`,color:m.name}),a(null),i?.()}catch(b){const O=b instanceof Error?b.message:"Unknown error";console.error("[PreviewCanvas] Render error:",O),a(`Rendering failed: ${O}`)}finally{c(!1)}})()},[n,e,t,r,m,y,d,i]),!n||!e?u.jsx("div",{className:`flex items-center justify-center aspect-video bg-muted rounded-lg ${s}`,children:u.jsxs("div",{className:"text-center text-muted-foreground",children:[u.jsx("p",{className:"text-lg font-medium",children:"No image to preview"}),u.jsx("p",{className:"text-sm mt-2",children:"Upload an image or start camera to begin"})]})}):u.jsxs("div",{className:`relative ${s}`,children:[u.jsx("canvas",{ref:g,className:"w-full h-auto rounded-lg shadow-lg",style:{display:"block"}}),l&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 backdrop-blur-sm rounded-lg",children:u.jsx("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"})}),o&&u.jsxs("div",{className:"absolute top-4 left-4 right-4 p-4 rounded-lg bg-destructive/90 backdrop-blur-sm flex items-start gap-3",children:[u.jsx(rt,{className:"w-5 h-5 text-destructive-foreground flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-destructive-foreground",children:"Rendering Error"}),u.jsx("p",{className:"text-xs text-destructive-foreground/90 mt-1",children:o})]})]}),!d&&!o&&u.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded-lg bg-yellow-500/90 backdrop-blur-sm",children:u.jsx("p",{className:"text-xs font-medium text-yellow-950",children:"⚠️ WebGL not available. Using basic rendering mode."})}),p.current>0&&!1]})}function ns(n){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function ss(n,e,t){n/=255,e/=255,t/=255;const r=Math.max(n,e,t),s=Math.min(n,e,t);let i=0,o=0;const a=(r+s)/2;if(r!==s){const l=r-s;switch(o=a>.5?l/(2-r-s):l/(r+s),r){case n:i=((e-t)/l+(e<t?6:0))/6;break;case e:i=((t-n)/l+2)/6;break;case t:i=((n-e)/l+4)/6;break}}return{h:i*360,s:o*100,l:a*100}}function j(n,e,t){const r=ns(t),s=ss(r.r,r.g,r.b);return{id:n,name:`colors.${n}.name`,category:e,hex:t,rgb:r,hsl:s,description:`colors.${n}.description`}}const is=[j("black","natural","#2C1B0E"),j("dark-brown","natural","#6B4423"),j("chestnut","natural","#8B4513"),j("auburn","natural","#A0522D"),j("light-brown","natural","#B8860B"),j("blonde","natural","#E6B87D"),j("platinum","natural","#F5F5DC"),j("gray","natural","#C0C0C0")],os=[j("red","vibrant","#FF0000"),j("burgundy","vibrant","#8B0000"),j("copper","vibrant","#D2691E"),j("pink","vibrant","#FF1493"),j("purple","vibrant","#9B59B6"),j("blue","vibrant","#3498DB"),j("green","vibrant","#27AE60"),j("turquoise","vibrant","#1ABC9C")],as=[j("pastel-pink","pastel","#FFB6C1"),j("pastel-purple","pastel","#E0BBE4"),j("pastel-blue","pastel","#AEC6CF"),j("pastel-mint","pastel","#B2E5D4"),j("pastel-peach","pastel","#FFDAB9"),j("rose-gold","pastel","#ECC5C0")],ls=[j("rainbow","fantasy","#FF69B4"),j("galaxy","fantasy","#4B0082"),j("neon-green","fantasy","#39FF14"),j("neon-orange","fantasy","#FF6600"),j("electric-blue","fantasy","#00FFFF")],cs=[...is,...os,...as,...ls],ne=cs,us=n=>n<640?"mobile":n<1024?"tablet":"desktop";function or(){const[n,e]=x.useState(typeof window<"u"?window.innerWidth:1024);x.useEffect(()=>{const r=()=>{e(window.innerWidth)};let s;const i=()=>{clearTimeout(s),s=setTimeout(r,150)};return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i),clearTimeout(s)}},[]);const t=us(n);return{breakpoint:t,isMobile:t==="mobile",isTablet:t==="tablet",isDesktop:t==="desktop",isMobileOrTablet:t==="mobile"||t==="tablet",width:n}}const ds=Array.from(new Set(ne.map(n=>n.category)));function $t({className:n="",onColorSelect:e}){const{t,ready:r}=be(),[s,i]=x.useState(""),[o,a]=x.useState(null),{selectedColor:l,setSelectedColor:c}=H(),{isMobile:d}=or();if(!r)return u.jsx("div",{className:n,children:"Loading..."});const f=ne.filter(m=>{if(o&&m.category!==o)return!1;if(s){const y=s.toLowerCase(),w=t(m.name).toLowerCase(),C=m.description?t(m.description).toLowerCase():"";return w.includes(y)||C.includes(y)||m.category.toLowerCase().includes(y)}return!0}),g=m=>{c(m),e?.(m)},h=()=>{i("")},p=()=>{a(null)};return u.jsxs("div",{className:`w-full ${n}`,children:[!d&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold mb-2",children:t("colorPalette.title")}),u.jsx("p",{className:"text-sm text-muted-foreground",children:t("colorPalette.description",{count:ne.length})})]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),u.jsx("input",{type:"text",placeholder:t("colorPalette.searchPlaceholder"),value:s,onChange:m=>i(m.target.value),className:"w-full pl-10 pr-10 py-2 rounded-lg border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-primary"}),s&&u.jsx("button",{onClick:h,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:u.jsx(Jt,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"mb-6",children:u.jsxs("div",{className:`flex gap-2 ${d?"overflow-x-auto pb-2 -mx-4 px-4 snap-x snap-mandatory":"flex-wrap"}`,children:[u.jsx("button",{onClick:p,className:`${d?"snap-start flex-shrink-0":""} px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o?"bg-muted text-muted-foreground hover:bg-muted/80":"bg-primary text-primary-foreground"} ${d?"min-h-[44px]":""}`,children:t("colorPalette.allColors")}),ds.map(m=>{const y=ne.filter(w=>w.category===m).length;return u.jsxs("button",{onClick:()=>a(m),className:`${d?"snap-start flex-shrink-0":""} px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o===m?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"} ${d?"min-h-[44px]":""}`,children:[t(`colorPalette.${m}`)," (",y,")"]},m)})]})}),l&&u.jsx("div",{className:`mb-6 rounded-lg bg-primary/10 border border-primary/20 ${d?"p-3":"p-4"}`,children:u.jsxs("div",{className:`flex items-center ${d?"gap-3":"gap-4"}`,children:[u.jsx("div",{className:`rounded-lg border-2 border-white shadow-lg ${d?"w-12 h-12":"w-16 h-16"}`,style:{backgroundColor:l.hex}}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:`font-semibold truncate ${d?"text-base":"text-lg"}`,children:t(l.name)}),!d&&l.description&&u.jsx("p",{className:"text-sm text-muted-foreground",children:t(l.description)}),u.jsxs("p",{className:"text-muted-foreground mt-1 text-xs",children:[t(`colorPalette.${l.category}`)," • ",l.hex]})]})]})}),u.jsx("div",{className:`grid gap-4 ${d?"grid-cols-2":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"}`,children:f.map(m=>{const y=l?.id===m.id;return u.jsxs("button",{onClick:()=>g(m),className:`
                group relative flex flex-col items-center rounded-lg
                transition-all duration-200
                ${d?"gap-2 p-2 min-h-[120px]":"gap-2 p-3"}
                ${y?"bg-primary/20 border-2 border-primary ring-2 ring-primary/50 scale-105":"bg-muted/50 border border-transparent hover:border-primary/50 hover:bg-muted hover:scale-102"}
              `,children:[u.jsx("div",{className:`
                  w-full aspect-square rounded-lg shadow-md
                  transition-transform duration-200
                  ${y?"scale-105 ring-2 ring-primary":"group-hover:scale-105"}
                `,style:{backgroundColor:m.hex}}),u.jsx("div",{className:"w-full text-center",children:u.jsx("p",{className:`font-medium line-clamp-2 ${d?"text-xs":"text-sm"} ${y?"text-primary":"text-foreground"}`,children:t(m.name)})}),y&&u.jsx("div",{className:`absolute -top-2 -right-2 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold shadow-lg ${d?"w-5 h-5 text-xs":"w-6 h-6 text-xs"}`,children:"✓"})]},m.id)})}),f.length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:t("colorPalette.noResults")}),u.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:t("colorPalette.tryAdjusting")}),u.jsx("button",{onClick:()=>{h(),p()},className:"px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90",children:t("colorPalette.clearFilters")})]}),f.length>0&&f.length<ne.length&&u.jsx("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:t("colorPalette.showingCount",{current:f.length,total:ne.length})})]})}function fs({isOpen:n,onClose:e,children:t,title:r,snapPoints:s=[.9],initialSnap:i=0,showCloseButton:o=!0,className:a=""}){const[l,c]=x.useState(i),d=x.useRef(null),f=x.useRef(0),g=x.useRef(0);x.useEffect(()=>{n&&c(i)},[n,i]),x.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]);const h=w=>{f.current=w.touches[0].clientY,g.current=f.current},p=w=>{g.current=w.touches[0].clientY;const C=g.current-f.current;C>0&&d.current&&(d.current.style.transform=`translateY(${C}px)`)},m=()=>{const w=g.current-f.current;d.current&&(d.current.style.transform=""),w>100&&e()};if(!n)return null;const y=s[l]*100;return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 bg-black/40 z-40 transition-opacity duration-300 backdrop-blur-sm",onClick:e,"aria-hidden":"true"}),u.jsxs("div",{ref:d,className:`
          fixed bottom-0 left-0 right-0 z-50
          bg-white rounded-t-3xl shadow-2xl
          transform transition-transform duration-300 ease-out
          ${n?"translate-y-0":"translate-y-full"}
          ${a}
        `,style:{maxHeight:`${y}vh`,paddingBottom:"env(safe-area-inset-bottom, 0px)"},role:"dialog","aria-modal":"true","aria-label":r||"Bottom sheet",children:[u.jsx("div",{className:"pt-3 pb-2 cursor-grab active:cursor-grabbing",onTouchStart:h,onTouchMove:p,onTouchEnd:m,children:u.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto"})}),(r||o)&&u.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold",children:r||""}),o&&u.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:u.jsx(Jt,{className:"w-5 h-5"})})]}),u.jsx("div",{className:"overflow-y-auto overscroll-contain",style:{maxHeight:`calc(${y}vh - 120px)`},children:t})]})]})}function gs(){const{t:n,ready:e}=be(),t=sr(),r=H(o=>o.setSegmentationMethod);if(!e)return null;const s=[{id:"modnet",name:n("segmentation.aiSegmentation")||"AI Segmentation",description:n("segmentation.aiDescription")||"Fast browser-based processing",icon:dn,badge:n("segmentation.recommended")||"Recommended",disabled:!0},{id:"server",name:n("segmentation.serverSide")||"Server-side",description:n("segmentation.serverDescription")||"Cloud processing for highest quality",icon:un,badge:n("segmentation.comingSoon")||"Coming Soon",disabled:!0}].filter(o=>o.id!=="modnet"),i=o=>{if(o==="server"){console.log("Server-side segmentation coming soon!");return}r(o)};return u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:n("segmentation.title")}),u.jsx("p",{className:"text-sm text-muted-foreground",children:n("segmentation.description")})]}),u.jsx("div",{className:"space-y-3",children:s.map(o=>{const a=o.icon,l=t===o.id,c=o.disabled;return u.jsx("button",{onClick:()=>i(o.id),disabled:c,className:`
                w-full text-left p-4 rounded-lg border-2 transition-all
                ${l?"border-primary bg-primary/5":c?"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}
              `,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:`
                    p-2 rounded-lg
                    ${l?"bg-primary text-primary-foreground":c?"bg-gray-200 text-gray-400":"bg-muted text-muted-foreground"}
                  `,children:u.jsx(a,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("h3",{className:`font-semibold ${c?"text-gray-400":""}`,children:o.name}),o.badge&&u.jsx("span",{className:`
                          text-xs px-2 py-0.5 rounded-full font-medium
                          ${c?"bg-gray-200 text-gray-500":l?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}
                        `,children:o.badge})]}),u.jsx("p",{className:`text-sm ${c?"text-gray-400":"text-muted-foreground"}`,children:o.description})]}),l&&!c&&u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:"w-5 h-5 rounded-full bg-primary flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-primary-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})})]})},o.id)})})]})}const zt=[{code:"zh-CN",name:"Simplified Chinese",nativeName:"简体中文"},{code:"en",name:"English",nativeName:"English"}];function hs(){const{i18n:n}=be(),e=Vn(),t=H(i=>i.setLanguage),r=i=>{t(i),n.changeLanguage(i)},s=zt.find(i=>i.code===e);return u.jsxs("div",{className:"relative group",children:[u.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-muted transition-colors","aria-label":"Select language",children:[u.jsx(an,{className:"w-5 h-5"}),u.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:s?.nativeName})]}),u.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:u.jsx("div",{className:"py-1",children:zt.map(i=>u.jsxs("button",{onClick:()=>r(i.code),className:`w-full text-left px-4 py-2 hover:bg-muted transition-colors flex items-center justify-between ${e===i.code?"bg-primary/10 text-primary":""}`,children:[u.jsx("span",{className:"text-sm font-medium",children:i.nativeName}),e===i.code&&u.jsx("span",{className:"text-primary text-lg",children:"✓"})]},i.code))})})]})}function ps(){const{t:n}=be(),[e,t]=x.useState("upload"),[r,s]=x.useState(!1),{isMobile:i,isTablet:o}=or(),a=H(g=>g.currentImage),l=H(g=>g.currentMask),c=H(g=>g.selectedColor),d=()=>{const g=document.querySelector("canvas");if(!g)return;const h=document.createElement("a");h.download=`hair-color-${c?.name||"preview"}-${Date.now()}.jpg`,h.href=g.toDataURL("image/jpeg",.9),h.click()},f=a&&l&&c;return u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50",children:[u.jsx("header",{className:"bg-white/95 backdrop-blur-md shadow-sm sticky top-0 z-40 safe-top",children:u.jsx("div",{className:"container mx-auto px-4 py-3 md:py-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h1",{className:`font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent ${i?"text-lg":"text-2xl md:text-3xl"}`,children:n(i?"app.titleMobile":"app.title")}),!i&&u.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n("app.subtitle")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(hs,{}),(i||o)&&u.jsxs("button",{onClick:()=>s(!r),className:`flex items-center justify-center gap-2 rounded-lg font-medium transition-colors ${i?"w-11 h-11":"px-4 py-2"} ${r?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,"aria-label":"Toggle color palette",children:[u.jsx(ln,{className:"w-5 h-5"}),!i&&u.jsx("span",{children:n("header.colors")})]}),f&&u.jsxs("button",{onClick:d,className:`flex items-center justify-center gap-2 rounded-lg font-medium bg-green-600 text-white hover:bg-green-700 transition-colors ${i?"w-11 h-11":"px-4 py-2"}`,"aria-label":"Download colored photo",children:[u.jsx(on,{className:"w-5 h-5"}),!i&&u.jsx("span",{children:n("header.download")})]})]})]})})}),u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"flex justify-center mb-6 md:mb-8",children:u.jsxs("div",{className:`inline-flex rounded-lg bg-white shadow-md p-1 ${i?"w-full max-w-md":""}`,children:[u.jsxs("button",{onClick:()=>t("upload"),className:`flex items-center justify-center gap-2 rounded-md font-medium transition-all ${i?"flex-1 py-3 px-4":"px-6 py-3"} ${e==="upload"?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:[u.jsx(Yt,{className:"w-5 h-5"}),u.jsx("span",{className:i?"text-sm":"",children:n("modes.upload")})]}),u.jsxs("button",{onClick:()=>t("camera"),className:`flex items-center justify-center gap-2 rounded-md font-medium transition-all ${i?"flex-1 py-3 px-4":"px-6 py-3"} ${e==="camera"?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:[u.jsx(Ke,{className:"w-5 h-5"}),u.jsx("span",{className:i?"text-sm":"",children:n("modes.camera")})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e==="upload"?u.jsx(qe,{className:"w-6 h-6 text-primary"}):u.jsx(Ke,{className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-2xl font-semibold",children:n(e==="upload"?"upload.title":"camera.title")})]}),e==="upload"?u.jsx(qn,{}):u.jsx(Zn,{applyColor:!0})]}),f&&u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-semibold",children:n("preview.title")}),u.jsx("div",{className:"px-3 py-1 rounded-lg bg-primary/10 text-primary text-sm font-medium",children:c.name})]}),u.jsx(rs,{sourceImage:a.element,hairMask:l.data,maskWidth:l.width,maskHeight:l.height})]}),!f&&u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-12",children:u.jsxs("div",{className:"text-center text-muted-foreground",children:[u.jsx(qe,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),u.jsx("h3",{className:"text-lg font-semibold mb-2",children:n("preview.noPreview")}),u.jsx("p",{className:"text-sm",children:n(e==="upload"?"preview.noPreviewUpload":"preview.noPreviewCamera")})]})})]}),!i&&!o&&u.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u.jsx("div",{className:"sticky top-24",children:u.jsx(gs,{})}),u.jsx("div",{className:"sticky top-24",children:u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsx($t,{})})})]})]}),(i||o)&&u.jsx(fs,{isOpen:r,onClose:()=>s(!1),title:n("colorPalette.title"),snapPoints:[.85,.6],initialSnap:0,children:u.jsx("div",{className:"px-4 pb-safe-bottom",children:u.jsx($t,{})})}),u.jsx("footer",{className:"mt-16 text-center text-sm text-muted-foreground",children:u.jsxs("p",{children:[n("footer.copyrightPrefix")," ",u.jsx("a",{href:"https://www.shiftrightlabs.com/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition-colors font-medium",children:n("footer.companyName")}),". ",n("footer.copyrightSuffix")]})})]})]})}const ms={title:"虚拟染发试色",titleMobile:"染发试色",subtitle:""},xs={colors:"选色",download:"下载"},ys={upload:"上传照片",camera:"实时摄像"},bs={title:"上传您的照片",dropHere:"拖放图片到这里",uploadYourPhoto:"上传您的照片",dragAndDrop:"拖放或点击浏览",supported:"支持格式：JPG、PNG、WebP（最大 10MB）",processing:"正在处理图片...",detecting:"正在检测头发区域...",loadingModel:"正在加载 AI 模型...",pleaseWait:"请稍候...",uploaded:"图片已上传！",uploadDifferent:"点击上传其他照片",error:"错误",invalidFileType:"文件格式无效。请上传 JPG、JPEG、PNG、WEBP 格式的文件。",fileTooLarge:"文件过大（{{size}}MB）。最大文件大小为 10MB。",failedToLoad:"图片加载失败。文件可能已损坏。",failedToRead:"文件读取失败。请重试。",requirements:"最佳效果建议：",clearPhoto:"清晰明亮的照片",hairVisible:"头发完全可见",frontFacing:"正面或四分之三侧面角度",plainBackground:"建议使用纯色背景"},vs={title:"实时摄像预览"},ws={title:"预览",confidence:"",rendering:"",noPreview:"暂无预览",noPreviewUpload:"上传照片并选择颜色以查看预览",noPreviewCamera:"启动摄像头并选择颜色以查看预览"},Ss={title:"选择您的颜色",description:"选择一个发色进行预览。共有 {{count}} 种颜色可选。",searchPlaceholder:"搜索颜色...",allColors:"全部颜色",natural:"自然色",vibrant:"鲜艳色",pastel:"柔和色",fantasy:"幻彩色",noResults:"未找到颜色",tryAdjusting:"尝试调整搜索或分类筛选",clearFilters:"清除筛选",showingCount:"显示 {{current}} / {{total}} 种颜色"},Cs={title:"处理模式",description:"选择处理模式以获得最佳效果",aiSegmentation:"客户端处理",aiDescription:"快速、隐私优先的浏览器内处理。",serverSide:"服务器端",serverDescription:"云端处理以获得最高质量。",recommended:"推荐",comingSoon:"即将推出",howItWorks:"",howItWorksText:""},Ns={copyrightPrefix:"© 2025",companyName:"Shift Right Labs",copyrightSuffix:"版权所有"},Rs={name:"简体中文",switchTo:"切换至{{language}}"},Es={black:{name:"黑色",description:"深邃浓郁的黑色，适合打造戏剧效果"},"dark-brown":{name:"深棕色",description:"经典深棕色，适合所有人"},chestnut:{name:"栗色",description:"温暖的栗棕色，带有红色底色"},auburn:{name:"赤褐色",description:"浓郁的赤褐色，带有自然红色高光"},"light-brown":{name:"浅棕色",description:"柔和的浅棕色，带有金色色调"},blonde:{name:"金色",description:"经典金发色，温暖明亮"},platinum:{name:"铂金色",description:"超浅铂金发色"},gray:{name:"银灰色",description:"优雅的银灰色"},red:{name:"鲜红色",description:"大胆火热的红色，适合个性造型"},burgundy:{name:"酒红色",description:"深邃的酒红色"},copper:{name:"铜色",description:"明亮的铜橙色"},pink:{name:"热粉色",description:"炫亮的热粉色"},purple:{name:"紫色",description:"浓郁的紫罗兰色"},blue:{name:"蓝色",description:"明亮的天蓝色"},green:{name:"绿色",description:"生动的翡翠绿色"},turquoise:{name:"青绿色",description:"明亮的青绿蓝色"},"pastel-pink":{name:"柔粉色",description:"柔和梦幻的粉色"},"pastel-purple":{name:"柔紫色",description:"精致的薰衣草紫色"},"pastel-blue":{name:"柔蓝色",description:"浅天蓝色"},"pastel-mint":{name:"薄荷绿",description:"清新的薄荷绿色"},"pastel-peach":{name:"柔桃色",description:"柔和的桃珊瑚色"},"rose-gold":{name:"玫瑰金",description:"时尚的玫瑰金混合色"},rainbow:{name:"彩虹色",description:"多彩彩虹效果（基色：热粉色）"},galaxy:{name:"星系色",description:"深邃的太空紫蓝混合色"},"neon-green":{name:"荧光绿",description:"电光荧光绿色"},"neon-orange":{name:"荧光橙",description:"明亮的荧光橙色"},"electric-blue":{name:"电光蓝",description:"明亮的电光青色"}},Ps={app:ms,header:xs,modes:ys,upload:bs,camera:vs,preview:ws,colorPalette:Ss,segmentation:Cs,footer:Ns,language:Rs,colors:Es},Ls={title:"VIRTUAL HAIR COLOR TRY ON",titleMobile:"Hair Color Try On",subtitle:""},ks={colors:"Colors",download:"Download"},js={upload:"Upload Photo",camera:"Live Camera"},_s={title:"Upload Your Photo",dropHere:"Drop image here",uploadYourPhoto:"Upload your photo",dragAndDrop:"Drag and drop or click to browse",supported:"Supported: JPG, PNG, WebP (max 10MB)",processing:"Processing image...",detecting:"Detecting hair areas...",loadingModel:"Loading AI model...",pleaseWait:"Please wait...",uploaded:"Image uploaded!",uploadDifferent:"Click to upload a different photo",error:"Error",invalidFileType:"Invalid file type. Please upload JPG, JPEG, PNG, WEBP files only.",fileTooLarge:"File too large ({{size}}MB). Maximum size is 10MB.",failedToLoad:"Failed to load image. File may be corrupted.",failedToRead:"Failed to read file. Please try again.",requirements:"Requirements for best results:",clearPhoto:"Clear, well-lit photo",hairVisible:"Hair fully visible",frontFacing:"Front-facing or 3/4 angle",plainBackground:"Plain background recommended"},Os={title:"Live Camera Preview"},Ts={title:"Preview",confidence:"",rendering:"",noPreview:"No Preview Yet",noPreviewUpload:"Upload a photo and select a color to see the preview",noPreviewCamera:"Start the camera and select a color to see the preview"},Fs={title:"Choose Your Color",description:"Select a hair color to preview. {{count}} colors available.",searchPlaceholder:"Search colors...",allColors:"All Colors",natural:"Natural",vibrant:"Vibrant",pastel:"Pastel",fantasy:"Fantasy",noResults:"No colors found",tryAdjusting:"Try adjusting your search or category filter",clearFilters:"Clear Filters",showingCount:"Showing {{current}} of {{total}} colors"},Is={title:"Processing Mode",description:"Select processing mode for best results",aiSegmentation:"Client-Side",aiDescription:"Fast, privacy-first processing in your browser.",serverSide:"Server-Side",serverDescription:"Cloud processing for maximum quality.",recommended:"Recommended",comingSoon:"Coming Soon",howItWorks:"",howItWorksText:""},Ms={copyrightPrefix:"© 2025",companyName:"Shift Right Labs",copyrightSuffix:"All rights reserved."},As={name:"English",switchTo:"Switch to {{language}}"},Ds={black:{name:"Black",description:"Deep, rich black for dramatic looks"},"dark-brown":{name:"Dark Brown",description:"Classic dark brown, universally flattering"},chestnut:{name:"Chestnut",description:"Warm chestnut brown with red undertones"},auburn:{name:"Auburn",description:"Rich auburn with natural red highlights"},"light-brown":{name:"Light Brown",description:"Soft, light brown with golden tones"},blonde:{name:"Blonde",description:"Classic blonde, warm and luminous"},platinum:{name:"Platinum Blonde",description:"Ultra-light platinum blonde"},gray:{name:"Silver Gray",description:"Elegant silver gray"},red:{name:"Vibrant Red",description:"Bold, fiery red for statement looks"},burgundy:{name:"Burgundy",description:"Deep burgundy red"},copper:{name:"Copper",description:"Bright copper orange"},pink:{name:"Hot Pink",description:"Electric hot pink"},purple:{name:"Purple",description:"Rich purple violet"},blue:{name:"Blue",description:"Bright sky blue"},green:{name:"Green",description:"Vivid emerald green"},turquoise:{name:"Turquoise",description:"Bright turquoise blue"},"pastel-pink":{name:"Pastel Pink",description:"Soft, dreamy pink"},"pastel-purple":{name:"Pastel Purple",description:"Delicate lavender purple"},"pastel-blue":{name:"Pastel Blue",description:"Light sky blue"},"pastel-mint":{name:"Mint Green",description:"Fresh mint green"},"pastel-peach":{name:"Pastel Peach",description:"Soft peachy coral"},"rose-gold":{name:"Rose Gold",description:"Trendy rose gold blend"},rainbow:{name:"Rainbow",description:"Multi-color rainbow effect (base: hot pink)"},galaxy:{name:"Galaxy",description:"Deep space purple-blue blend"},"neon-green":{name:"Neon Green",description:"Electric neon green"},"neon-orange":{name:"Neon Orange",description:"Bright neon orange"},"electric-blue":{name:"Electric Blue",description:"Bright electric cyan"}},$s={app:Ls,header:ks,modes:js,upload:_s,camera:Os,preview:Ts,colorPalette:Fs,segmentation:Is,footer:Ms,language:As,colors:Ds},zs=()=>{try{return typeof window<"u"&&window.localStorage?localStorage.getItem("language"):null}catch{return console.warn("localStorage not available, using default language"),null}};U.use(Kr).init({resources:{"zh-CN":{translation:Ps},en:{translation:$s}},lng:zs()||"zh-CN",fallbackLng:"zh-CN",interpolation:{escapeValue:!1},react:{useSuspense:!1}});pr.createRoot(document.getElementById("root")).render(u.jsx(fe.StrictMode,{children:u.jsx(ps,{})}));
